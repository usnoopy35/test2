<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…’ç«¥ç”Ÿé•·ç´€éŒ„ | ä¸‹ç­å¾Œçš„æŸå®…ç¾Š</title>
    <link rel="icon" href="https://duk.tw/X9d3qU.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        
        /* --- CSS Variables for Theming --- */
        :root {
            --primary-color: #8D6E63;
            --primary-hover: #6D4C41;
            --secondary-bg: #FFF3E0;
            --secondary-border: #FFE0B2;
            --text-dark: #5D4037;
            --bg-color: #fdfbf7;
            --card-accent: #FFF8E1;
        }

        /* Boy Theme */
        body.theme-boy {
            --primary-color: #42A5F5;
            --primary-hover: #1E88E5;
            --secondary-bg: #E3F2FD;
            --secondary-border: #BBDEFB;
            --text-dark: #0D47A1;
            --bg-color: #F1F8E9;
            --card-accent: #E1F5FE;
        }

        /* Girl Theme */
        body.theme-girl {
            --primary-color: #EC407A;
            --primary-hover: #D81B60;
            --secondary-bg: #FCE4EC;
            --secondary-border: #F8BBD0;
            --text-dark: #880E4F;
            --bg-color: #FFF5F7;
            --card-accent: #FFF0F5;
        }

        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--bg-color); transition: background-color 0.5s; }
        
        .text-theme-dark { color: var(--text-dark); }
        .text-theme-primary { color: var(--primary-color); }
        .bg-theme-header { background-color: var(--secondary-bg); }
        .bg-theme-accent { background-color: var(--card-accent); }
        .border-theme { border-color: var(--secondary-border); }

        .btn-primary { background-color: var(--primary-color); color: white; transition: 0.3s; }
        .btn-primary:hover { background-color: var(--primary-hover); }
        .btn-secondary { background-color: var(--secondary-bg); color: var(--text-dark); border: 1px solid var(--secondary-border); transition: 0.3s; }
        .btn-secondary:hover { filter: brightness(0.95); }
        
        .card { background: white; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .chart-container { position: relative; height: 400px; width: 100%; }
        
        /* Tabs */
        .tab-btn { border-bottom: 3px solid transparent; color: #888; padding-bottom: 0.5rem; transition: all 0.3s; }
        .tab-btn.active { border-bottom: 3px solid var(--primary-color); color: var(--text-dark); font-weight: bold; }
        
        .modal { transition: opacity 0.25s ease; }
        body.modal-active { overflow-x: hidden; overflow-y: visible !important; }

        /* --- Improved Teeth Styling --- */
        .dental-chart {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
            padding: 20px 0;
            overflow-x: auto; /* Handle small screens */
        }

        .dental-arch {
            position: relative;
            width: 300px;
            height: 160px;
            flex-shrink: 0;
        }

        /* Upper Arch (Inverted U) */
        .dental-arch.upper {
            border-bottom: 2px solid rgba(0,0,0,0.05);
        }

        .tooth-container {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transform-origin: center center;
            width: 24px;
            height: 40px;
            transition: all 0.5s;
        }
        
        .tooth-mark {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background-color: #eee;
            border: 1px solid #ddd;
            margin: 1px;
            transition: 0.3s;
            box-shadow: inset 1px 1px 2px rgba(0,0,0,0.05);
        }

        .tooth-mark.primary { width: 16px; height: 16px; border-radius: 6px; }
        .tooth-mark.permanent { width: 20px; height: 20px; border-radius: 4px; }

        /* States */
        .tooth-mark.primary.erupted {
            background-color: #fff;
            border: 2px solid #81C784;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transform: scale(1.1);
        }
        
        .tooth-mark.permanent.erupted {
            background-color: #FFF9C4;
            border: 2px solid #FBC02D;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transform: scale(1.1);
            z-index: 10;
        }

        .tooth-mark.shed {
            background-color: transparent;
            border: 1px dashed #ccc;
            opacity: 0.3;
        }

        .arch-label {
            position: absolute;
            width: 100%;
            text-align: center;
            font-size: 12px;
            color: #ccc;
            font-weight: bold;
            pointer-events: none;
        }
        .dental-arch.upper .arch-label { bottom: 10px; }
        .dental-arch.lower .arch-label { top: 10px; }

        .item-tag {
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-right: 6px;
            background-color: #f3f4f6;
            color: #6b7280;
            display: inline-block;
            font-weight: normal;
        }
        .item-tag.book { background-color: #e0f2fe; color: #0369a1; }
        .item-tag.game { background-color: #fef3c7; color: #b45309; }

    </style>
</head>
<body class="text-gray-700 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-theme-header p-4 shadow-sm sticky top-0 z-40 transition-colors duration-500">
        <div class="max-w-4xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3 cursor-pointer" onclick="showView('listView')">
                <img src="https://duk.tw/X9d3qU.png" alt="Logo" class="w-10 h-10 rounded-full border-2 border-white shadow-sm">
                <h1 class="text-xl font-bold text-theme-dark flex items-center gap-2 flex-wrap">
                    å…’ç«¥ç”Ÿé•·ç´€éŒ„
                    <span class="text-sm font-normal text-theme-primary inline-flex items-center">| 
                        <a href="https://www.facebook.com/profile.php?id=61584059466555" target="_blank" class="hover:text-theme-primary transition-colors hover:underline ml-1">
                            ä¸‹ç­å¾Œçš„æŸå®…ç¾Š
                        </a>
                    </span>
                </h1>
            </div>
            <div id="headerActions"></div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto p-4 w-full flex-grow">

        <!-- VIEW: Child List (Home) -->
        <section id="listView" class="space-y-6">
            <div class="flex flex-col md:flex-row justify-between items-end mb-4 gap-4">
                <div>
                    <h2 class="text-2xl font-bold text-theme-dark">å°æœ‹å‹åˆ—è¡¨</h2>
                    <p class="text-sm text-gray-500">é¸æ“‡ä¸€ä½å°æœ‹å‹æŸ¥çœ‹ç”Ÿé•·ç´€éŒ„</p>
                </div>
                <div class="flex gap-2">
                    <button onclick="document.getElementById('importFile').click()" class="bg-gray-100 text-gray-600 px-3 py-2 rounded-lg shadow-sm hover:bg-gray-200 text-sm flex items-center gap-1 border border-gray-200">
                        <i class="fas fa-file-import"></i> åŒ¯å…¥è³‡æ–™
                    </button>
                    <input type="file" id="importFile" class="hidden" onchange="importData(this)" accept=".json">
                    
                    <button onclick="exportData()" class="bg-gray-100 text-gray-600 px-3 py-2 rounded-lg shadow-sm hover:bg-gray-200 text-sm flex items-center gap-1 border border-gray-200">
                        <i class="fas fa-file-export"></i> å‚™ä»½è³‡æ–™
                    </button>
                    
                    <button onclick="openModal('addChildModal')" class="btn-primary px-4 py-2 rounded-lg shadow-sm flex items-center gap-2">
                        <i class="fas fa-plus"></i> æ–°å¢å°æœ‹å‹
                    </button>
                </div>
            </div>

            <div id="childrenContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Children cards will be injected here -->
            </div>

            <div id="emptyState" class="hidden text-center py-12 bg-white rounded-xl border border-dashed border-gray-300">
                <div class="text-4xl mb-3">ğŸ‘¶</div>
                <p class="text-gray-500">é‚„æ²’æœ‰å»ºç«‹å°æœ‹å‹è³‡æ–™å–”ï¼</p>
                <button onclick="openModal('addChildModal')" class="mt-4 text-theme-primary font-bold hover:underline">é¦¬ä¸Šå»ºç«‹</button>
            </div>
        </section>

        <!-- VIEW: Child Detail -->
        <section id="detailView" class="hidden space-y-6">
            <!-- Child Profile Header -->
            <div class="card p-6 relative overflow-hidden">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                        <div class="flex items-center gap-3">
                            <h2 id="detailName" class="text-2xl font-bold text-theme-dark">--</h2>
                            <span id="detailGender" class="px-2 py-1 rounded text-xs font-bold bg-gray-100 text-gray-600">--</span>
                        </div>
                        <p class="text-sm text-gray-500 mt-1">
                            ç”Ÿæ—¥ï¼š<span id="detailDob">--</span> 
                            (ç›®å‰ <span id="detailAge">--</span>)
                            <span id="detailPremature" class="ml-2 text-xs text-red-400 font-bold hidden"></span>
                        </p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="deleteCurrentChild()" class="text-red-400 hover:text-red-600 px-3 py-2 text-sm border border-red-200 rounded-lg bg-white relative z-10">
                            <i class="fas fa-trash"></i> åˆªé™¤
                        </button>
                        <button onclick="showView('listView')" class="btn-secondary px-4 py-2 rounded-lg text-sm relative z-10">
                            <i class="fas fa-arrow-left"></i> è¿”å›åˆ—è¡¨
                        </button>
                    </div>
                </div>
            </div>

            <!-- Doctor's Advice Card -->
            <div id="adviceCard" class="card p-4 bg-gradient-to-r from-white to-gray-50 border-l-4 border-theme flex gap-4 animate-fade-in shadow-sm">
                <div class="text-3xl flex items-start pt-1">ğŸ‘¨ğŸ»â€âš•ï¸</div>
                <div>
                    <h3 class="font-bold text-theme-dark text-sm md:text-base mb-1">ä¾†è‡ªé†«å¸«çš„å°å®åš€ï¼š<span id="adviceTitle" class="text-theme-primary">--</span></h3>
                    <p id="adviceText" class="text-sm text-gray-600 leading-relaxed text-justify">--</p>
                </div>
            </div>

            <!-- Action Bar (Grid Layout: 2 Rows) -->
            <div class="grid grid-cols-4 gap-2 mb-4 bg-white p-2 rounded-xl shadow-sm border border-gray-100">
                <button onclick="switchDetailTab('record')" id="tab-record" class="tab-btn active flex flex-col items-center justify-center py-2 text-sm rounded hover:bg-gray-50">
                    <i class="fas fa-plus-circle text-lg mb-1"></i> ç´€éŒ„
                </button>
                <button onclick="switchDetailTab('chart')" id="tab-chart" class="tab-btn flex flex-col items-center justify-center py-2 text-sm rounded hover:bg-gray-50">
                    <i class="fas fa-chart-line text-lg mb-1"></i> æ›²ç·š
                </button>
                <button onclick="switchDetailTab('history')" id="tab-history" class="tab-btn flex flex-col items-center justify-center py-2 text-sm rounded hover:bg-gray-50">
                    <i class="fas fa-list text-lg mb-1"></i> åˆ—è¡¨
                </button>
                <button onclick="switchDetailTab('development')" id="tab-development" class="tab-btn flex flex-col items-center justify-center py-2 text-sm rounded hover:bg-gray-50">
                    <i class="fas fa-baby-carriage text-lg mb-1"></i> ç™¼å±•
                </button>
                <button onclick="switchDetailTab('vaccine')" id="tab-vaccine" class="tab-btn flex flex-col items-center justify-center py-2 text-sm rounded hover:bg-gray-50">
                    <i class="fas fa-syringe text-lg mb-1"></i> ç–«è‹—
                </button>
                <button onclick="switchDetailTab('teeth')" id="tab-teeth" class="tab-btn flex flex-col items-center justify-center py-2 text-sm rounded hover:bg-gray-50">
                    <i class="fas fa-tooth text-lg mb-1"></i> ç‰™é½’
                </button>
                <button onclick="switchDetailTab('recommend')" id="tab-recommend" class="tab-btn flex flex-col items-center justify-center py-2 text-sm rounded hover:bg-gray-50">
                    <i class="fas fa-gift text-lg mb-1"></i> æ¨è–¦
                </button>
                <button onclick="switchDetailTab('predict')" id="tab-predict" class="tab-btn flex flex-col items-center justify-center py-2 text-sm rounded hover:bg-gray-50">
                    <i class="fas fa-ruler-vertical text-lg mb-1"></i> é æ¸¬
                </button>
            </div>

            <!-- TAB: New Record -->
            <div id="content-record" class="tab-content card p-6">
                <h3 class="font-bold text-theme-dark mb-4">ğŸ“ è¼¸å…¥æ–°çš„æ¸¬é‡æ•¸æ“š</h3>
                <form id="recordForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium mb-1">æ¸¬é‡æ—¥æœŸ</label>
                        <div class="flex items-center border border-gray-300 rounded-lg overflow-hidden flex-1 bg-white h-10">
                            <span class="bg-gray-50 px-2 text-xs text-gray-500 h-full flex items-center border-r border-gray-200 min-w-[3rem] justify-center font-bold text-theme-primary">å¹´</span>
                            <input type="number" id="recYear" class="w-full h-full px-1 outline-none text-center text-theme-dark" placeholder="113æˆ–2024">
                            <span class="text-gray-300">/</span>
                            <input type="number" id="recMonth" class="w-full h-full px-1 outline-none text-center text-theme-dark" placeholder="æœˆ">
                            <span class="text-gray-300">/</span>
                            <input type="number" id="recDay" class="w-full h-full px-1 outline-none text-center text-theme-dark" placeholder="æ—¥">
                        </div>
                        <p class="text-xs text-gray-400 mt-1">* ç³»çµ±è‡ªå‹•è¾¨è­˜æ°‘åœ‹(3ç¢¼)æˆ–è¥¿å…ƒ(4ç¢¼)å¹´ä»½</p>
                    </div>
                    <div class="hidden md:block"></div>
                    <div>
                        <label class="block text-sm font-medium mb-1">èº«é«˜ (cm)</label>
                        <input type="number" step="0.1" id="recHeight" placeholder="ä¾‹å¦‚: 95.5" class="w-full border-gray-300 border rounded-lg p-2 focus:ring-2 focus:ring-current text-theme-primary outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">é«”é‡ (kg)</label>
                        <input type="number" step="0.1" id="recWeight" placeholder="ä¾‹å¦‚: 14.2" class="w-full border-gray-300 border rounded-lg p-2 focus:ring-2 focus:ring-current text-theme-primary outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">é ­åœ (cm) <span class="text-xs text-gray-400">(é¸å¡«)</span></label>
                        <input type="number" step="0.1" id="recHead" placeholder="ä¾‹å¦‚: 48.0" class="w-full border-gray-300 border rounded-lg p-2 focus:ring-2 focus:ring-current text-theme-primary outline-none">
                    </div>
                    <div class="md:col-span-2 pt-2">
                        <button type="button" onclick="addRecord()" class="w-full btn-primary py-3 rounded-lg font-bold shadow-md transform active:scale-95">
                            å„²å­˜ä¸¦åˆ†æ
                        </button>
                    </div>
                </form>
                <div id="instantResult" class="hidden mt-6 p-4 bg-theme-accent rounded-lg border border-theme animate-fade-in">
                    <h4 class="font-bold text-theme-dark mb-2 text-center">æœ¬æ¬¡è©•ä¼°çµæœ</h4>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                        <div class="bg-white p-2 rounded shadow-sm"><p class="text-xs text-gray-500">èº«é«˜</p><p class="font-bold text-blue-600 text-lg" id="resHeight">--</p></div>
                        <div class="bg-white p-2 rounded shadow-sm"><p class="text-xs text-gray-500">é«”é‡</p><p class="font-bold text-green-600 text-lg" id="resWeight">--</p></div>
                        <div class="bg-white p-2 rounded shadow-sm"><p class="text-xs text-gray-500">é ­åœ</p><p class="font-bold text-purple-600 text-lg" id="resHead">--</p></div>
                        <div class="bg-white p-2 rounded shadow-sm border border-blue-100"><p class="text-xs text-gray-500"><i class="fas fa-tint text-blue-400"></i> å»ºè­°æ¯æ—¥æ°´åˆ†æ”å–</p><p class="font-bold text-blue-500 text-lg" id="resWater">--</p></div>
                    </div>
                    <p class="text-xs text-center text-gray-400 mt-3">å–æ°´é‡è¨ˆç®—æ¡ç”¨ Holiday-Segar å…¬å¼ï¼ŒåŒ…å«å¥¶é‡èˆ‡æ¹¯å“ã€‚</p>
                </div>
            </div>

            <!-- TAB: Chart -->
            <div id="content-chart" class="tab-content hidden card p-4">
                 <div class="flex border-b border-gray-200 mb-4 overflow-x-auto">
                    <button class="chart-tab-btn active px-4 py-2 whitespace-nowrap text-sm font-bold text-theme-primary border-b-2 border-theme" onclick="switchChartType('height', this)">èº«é«˜æ›²ç·š</button>
                    <button class="chart-tab-btn px-4 py-2 whitespace-nowrap text-sm text-gray-500" onclick="switchChartType('weight', this)">é«”é‡æ›²ç·š</button>
                    <button class="chart-tab-btn px-4 py-2 whitespace-nowrap text-sm text-gray-500" onclick="switchChartType('head', this)">é ­åœæ›²ç·š</button>
                </div>
                <div class="chart-container">
                    <canvas id="growthChart"></canvas>
                </div>
                <p class="text-xs text-center text-gray-400 mt-2">* æ”¯æ´å¤šé»è§¸æ§ç¸®æ”¾ï¼Œé»æ“Šæ•¸æ“šé»å¯çœ‹è©³ç´°æ—¥æœŸ</p>
            </div>

            <!-- TAB: History -->
            <div id="content-history" class="tab-content hidden card overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left">
                        <thead class="bg-gray-50 text-gray-600">
                            <tr>
                                <th class="p-4 whitespace-nowrap">æ—¥æœŸ</th>
                                <th class="p-4 whitespace-nowrap">å¹´é½¡</th>
                                <th class="p-4">èº«é«˜</th>
                                <th class="p-4">é«”é‡</th>
                                <th class="p-4">é ­åœ</th>
                                <th class="p-4 text-blue-500 whitespace-nowrap">å»ºè­°æ¯æ—¥æ°´åˆ†æ”å–</th>
                                <th class="p-4 text-right">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody" class="divide-y divide-gray-100"></tbody>
                    </table>
                </div>
            </div>

            <!-- TAB: Development -->
            <div id="content-development" class="tab-content hidden card p-6">
                <div class="flex justify-between items-center mb-4 border-b border-theme pb-2">
                    <h3 class="font-bold text-theme-dark text-xl"><i class="fas fa-baby-carriage mr-2 text-theme-primary"></i> å…’ç«¥ç™¼å±•è©•ä¼°</h3>
                    <span id="devAgeStage" class="text-sm bg-theme-accent px-2 py-1 rounded text-theme-dark font-bold">--</span>
                </div>
                <div id="devListContainer" class="space-y-4"></div>
                <div class="mt-6 p-3 bg-yellow-50 text-yellow-700 text-xs rounded border border-yellow-100">
                    <i class="fas fa-exclamation-triangle mr-1"></i> æ³¨æ„ï¼šè‹¥æœ‰è¶…éä¸€åŠçš„é …ç›®æœªé”æ¨™ï¼Œå»ºè­°è«®è©¢å°å…’ç¥ç¶“ç§‘æˆ–å¾©å¥ç§‘é†«å¸«ã€‚
                </div>
            </div>

            <!-- TAB: Vaccine -->
            <div id="content-vaccine" class="tab-content hidden card p-6">
                <div class="flex justify-between items-center mb-4 border-b border-theme pb-2">
                    <h3 class="font-bold text-theme-dark text-xl"><i class="fas fa-syringe mr-2 text-theme-primary"></i> ç–«è‹—æ¥ç¨®æ™‚ç¨‹</h3>
                </div>
                <div class="flex gap-2 mb-4 text-xs justify-center">
                    <span class="flex items-center gap-1"><span class="w-4 h-4 rounded-full bg-green-500 flex items-center justify-center text-white text-[10px]"><i class="fas fa-check"></i></span> æ‡‰å·²æ–½æ‰“</span>
                    <span class="flex items-center gap-1"><span class="w-4 h-4 rounded-full bg-yellow-400 flex items-center justify-center text-white text-[10px]"><i class="fas fa-clock"></i></span> è¿‘æœŸç•™æ„</span>
                    <span class="flex items-center gap-1"><span class="w-4 h-4 rounded-full bg-blue-400 flex items-center justify-center text-white text-[10px]"><i class="fas fa-calendar-alt"></i></span> æœªä¾†è¡Œç¨‹</span>
                </div>
                <div id="vaccineListContainer" class="space-y-3"></div>
                <p class="text-xs text-center text-gray-400 mt-4">* æ™‚ç¨‹åƒè€ƒå°ç£ CDC å¸¸è¦ç–«è‹—ï¼Œå¯¦éš›æ¥ç¨®è«‹éµå¾ªé†«å¸«è©•ä¼°ã€‚</p>
            </div>

             <!-- TAB: Teeth -->
             <div id="content-teeth" class="tab-content hidden card p-6">
                <div class="flex justify-between items-center mb-4 border-b pb-2">
                    <h3 class="font-bold text-theme-dark">ğŸ¦· ç‰™é½’ç”Ÿé•·é€²åº¦</h3>
                    <div class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">ç›®å‰å¹´é½¡: <span id="teethAgeDisplay">--</span></div>
                </div>
                <div class="flex flex-wrap justify-center gap-3 mb-6 text-xs bg-gray-50 p-3 rounded-lg">
                    <div class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-white border border-green-400"></span> ä¹³ç‰™</div>
                    <div class="flex items-center gap-1"><span class="w-3 h-3 rounded bg-yellow-100 border border-yellow-400"></span> æ†ç‰™</div>
                    <div class="flex items-center gap-1"><span class="w-3 h-3 rounded border border-dashed border-gray-300 opacity-50"></span> æœªé•·</div>
                </div>
                <div class="dental-chart bg-theme-accent rounded-xl border border-theme">
                    <div class="dental-arch upper" id="jawUpper"><div class="arch-label">ä¸Šæ’ç‰™é½’ (Upper)</div></div>
                    <div class="dental-arch lower" id="jawLower"><div class="arch-label">ä¸‹æ’ç‰™é½’ (Lower)</div></div>
                </div>
                <div class="mt-6 space-y-3 p-4 rounded-lg bg-white border border-gray-100">
                    <h4 class="font-bold text-sm text-theme-dark border-b border-theme pb-1">ç™¼è‚²éšæ®µèªªæ˜</h4>
                    <p id="teethStageText" class="text-sm text-gray-600 leading-relaxed">--</p>
                </div>
            </div>

            <!-- TAB: Recommendations -->
            <div id="content-recommend" class="tab-content hidden card p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="font-bold text-theme-dark text-xl"><i class="fas fa-gift mr-2 text-theme-primary"></i> å°ˆå±¬å¥½ç‰©æ¨è–¦</h3>
                    <button onclick="refreshRecommendations()" class="text-sm bg-gray-100 px-3 py-1 rounded-full text-gray-600 hover:bg-gray-200 transition"><i class="fas fa-sync-alt mr-1"></i> æ›ä¸€çµ„</button>
                </div>
                <div class="mb-8">
                    <h4 class="font-bold text-gray-600 mb-3 border-l-4 border-theme pl-2">ğŸ“š é©åˆçš„åœ–æ›¸ (5æœ¬)</h4>
                    <div id="bookList" class="space-y-3"></div>
                </div>
                <div>
                    <h4 class="font-bold text-gray-600 mb-3 border-l-4 border-theme pl-2">ğŸ² é©åˆçš„æ¡ŒéŠ/ç©å…· (1æ¬¾)</h4>
                    <div id="gameList"></div>
                </div>
                <p class="text-xs text-gray-400 mt-6 text-center">æ¨è–¦æ¸…å–®ç”±ç³»çµ±æ ¹æ“šå¹´é½¡éš¨æ©ŸæŒ‘é¸ï¼Œåƒ…ä¾›åƒè€ƒã€‚</p>
            </div>

            <!-- TAB: Prediction -->
            <div id="content-predict" class="tab-content hidden card p-6">
                <div class="flex justify-between items-center mb-6 border-b border-theme pb-2">
                    <h3 class="font-bold text-theme-dark text-xl"><i class="fas fa-ruler-vertical mr-2 text-theme-primary"></i> æˆå¹´èº«é«˜é æ¸¬</h3>
                </div>
                <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-600 mb-1">çˆ¸çˆ¸èº«é«˜ (cm)</label>
                            <input type="number" id="predDad" class="w-full border rounded-lg p-2 focus:ring-2 focus:ring-current text-theme-primary" placeholder="175">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-600 mb-1">åª½åª½èº«é«˜ (cm)</label>
                            <input type="number" id="predMom" class="w-full border rounded-lg p-2 focus:ring-2 focus:ring-current text-theme-primary" placeholder="160">
                        </div>
                    </div>
                    <button onclick="calculatePrediction()" class="w-full btn-primary py-3 rounded-lg font-bold shadow-md">é–‹å§‹é æ¸¬</button>
                </div>
                <div id="predResult" class="hidden mt-6 bg-theme-accent p-6 rounded-xl text-center animate-fade-in border border-theme">
                    <p class="text-sm text-gray-500 mb-2">é ä¼°ç›®æ¨™èº«é«˜ (Target Height)</p>
                    <div class="text-4xl font-bold text-theme-primary mb-2"><span id="predValue">--</span> <span class="text-lg">cm</span></div>
                    <div class="text-sm text-gray-600">éºå‚³ç¯„åœï¼š <span id="predRange" class="font-bold">--</span></div>
                    <p class="text-xs text-gray-400 mt-4">* æ­¤å…¬å¼åŸºæ–¼çˆ¶æ¯èº«é«˜éºå‚³è¨ˆç®—ï¼Œå¯¦éš›èº«é«˜å—ç‡Ÿé¤Šã€ç¡çœ ã€é‹å‹•ç­‰å¤šé‡å› ç´ å½±éŸ¿ã€‚</p>
                </div>
            </div>

        </section>

    </main>

    <!-- Modals -->
    <div id="addChildModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-black opacity-50"></div>
        <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded-lg shadow-lg z-50 overflow-y-auto transform transition-all scale-95 opacity-0">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3 border-b mb-3">
                    <p class="text-2xl font-bold text-theme-dark">æ–°å¢ä¸€ä½å°æœ‹å‹</p>
                    <div class="modal-close cursor-pointer z-50" onclick="closeModal('addChildModal')"><i class="fas fa-times"></i></div>
                </div>
                <form id="addChildForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-bold mb-1">å°æœ‹å‹æš±ç¨±</label>
                        <input type="text" id="newChildName" placeholder="ä¾‹å¦‚: å°æ¹¯åœ“" class="w-full border rounded-lg p-2 outline-none focus:ring-2 focus:ring-current text-theme-primary">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-1">æ€§åˆ¥</label>
                        <div class="flex gap-4 mt-1">
                            <label class="flex items-center cursor-pointer p-2 border rounded-lg flex-1 justify-center hover:bg-blue-50 transition"><input type="radio" name="newChildGender" value="boy" checked class="w-4 h-4 text-blue-500"><span class="ml-2 font-bold text-blue-600">ğŸ‘¦ ç”·å¯¶</span></label>
                            <label class="flex items-center cursor-pointer p-2 border rounded-lg flex-1 justify-center hover:bg-pink-50 transition"><input type="radio" name="newChildGender" value="girl" class="w-4 h-4 text-pink-500"><span class="ml-2 font-bold text-pink-600">ğŸ‘§ å¥³å¯¶</span></label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-1">å‡ºç”Ÿé€±æ•¸ <span class="text-xs font-normal text-gray-500">(è¶³æœˆç‚º40é€±ï¼Œæ—©ç”¢è«‹å¡«å¯«)</span></label>
                        <input type="number" id="newChildWeeks" placeholder="40" value="40" min="20" max="42" class="w-full border rounded-lg p-2 outline-none focus:ring-2 focus:ring-current text-theme-primary">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-1">å‡ºç”Ÿæ—¥æœŸ</label>
                        <div class="flex items-center border border-gray-300 rounded-lg overflow-hidden flex-1 bg-white h-10">
                            <span class="bg-gray-50 px-2 text-xs text-gray-500 h-full flex items-center border-r border-gray-200 min-w-[3rem] justify-center" id="newChildYearLabel">å¹´</span>
                            <input type="number" id="newChildYear" class="w-full h-full px-1 outline-none text-center text-theme-dark" placeholder="113æˆ–2024">
                            <span class="text-gray-300">/</span>
                            <input type="number" id="newChildMonth" class="w-full h-full px-1 outline-none text-center text-theme-dark" placeholder="æœˆ">
                            <span class="text-gray-300">/</span>
                            <input type="number" id="newChildDay" class="w-full h-full px-1 outline-none text-center text-theme-dark" placeholder="æ—¥">
                        </div>
                        <p class="text-xs text-gray-400 mt-1">* ç³»çµ±è‡ªå‹•è¾¨è­˜æ°‘åœ‹(3ç¢¼)æˆ–è¥¿å…ƒ(4ç¢¼)å¹´ä»½</p>
                    </div>
                </form>
                <div class="flex justify-end pt-4 mt-4 border-t space-x-2">
                    <button onclick="closeModal('addChildModal')" class="px-4 py-2 bg-gray-200 rounded-lg text-gray-600 hover:bg-gray-300">å–æ¶ˆ</button>
                    <button onclick="saveNewChild()" class="px-4 py-2 btn-primary rounded-lg">å»ºç«‹æª”æ¡ˆ</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="alertModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-black opacity-50"></div>
        <div class="modal-container bg-white w-10/12 md:max-w-sm mx-auto rounded-lg shadow-lg z-50 overflow-y-auto transform transition-all scale-95 opacity-0">
            <div class="modal-content py-4 text-center px-6">
                <div class="text-4xl mb-2">ğŸ’¡</div>
                <h3 class="text-xl font-bold text-theme-dark mb-2" id="alertTitle">æç¤º</h3>
                <p class="text-gray-600 mb-6" id="alertMessage"></p>
                <button onclick="closeModal('alertModal')" class="w-full px-4 py-2 btn-primary rounded-lg">æˆ‘çŸ¥é“äº†</button>
            </div>
        </div>
    </div>
    <div id="confirmModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-black opacity-50"></div>
        <div class="modal-container bg-white w-10/12 md:max-w-sm mx-auto rounded-lg shadow-lg z-50 overflow-y-auto transform transition-all scale-95 opacity-0">
            <div class="modal-content py-4 text-center px-6">
                <div class="text-4xl mb-2 text-red-400">âš ï¸</div>
                <h3 class="text-xl font-bold text-theme-dark mb-2" id="confirmTitle">ç¢ºèª</h3>
                <p class="text-gray-600 mb-6" id="confirmMessage"></p>
                <div class="flex gap-2">
                    <button onclick="closeModal('confirmModal')" class="flex-1 px-4 py-2 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300">å–æ¶ˆ</button>
                    <button id="confirmYesBtn" class="flex-1 px-4 py-2 bg-red-400 text-white rounded-lg hover:bg-red-500">ç¢ºå®šåˆªé™¤</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ... (CONSTANTS same as before) ...
        const DATA_SOURCES = {
            boy: {
                height: [[0,1,49.884,0.03795],[6,1,67.62,0.03265],[12,1,75.75,0.03215],[24,1,87.8,0.0323],[36,1,96.1,0.0329],[48,1,103.3,0.0336],[60,1,110.0,0.0343],[84,1,122.5,0.045],[120,1,140.5,0.05],[144,1,155.0,0.055],[168,1,168.0,0.045],[216,1,172.5,0.04]],
                weight: [[0,0.3487,3.346,0.146],[6,0.0768,7.9,0.11],[12,0.015,9.6,0.108],[24,-0.05,12.2,0.11],[36,-0.09,14.3,0.115],[48,-0.11,16.3,0.12],[60,-0.12,18.3,0.125],[84,-0.15,23.5,0.14],[120,-0.2,35.0,0.16],[144,-0.2,48.0,0.18],[168,-0.1,60.0,0.15],[216,-0.05,65.0,0.14]],
                head: [[0,1,34.5,0.037],[6,1,43.3,0.03],[12,1,46.1,0.028],[24,1,48.2,0.027],[36,1,49.5,0.027],[48,1,50.2,0.027],[60,1,49.7,0.027]]
            },
            girl: {
                height: [[0,1,49.1,0.0379],[6,1,65.7,0.033],[12,1,74.0,0.033],[24,1,86.4,0.033],[36,1,95.1,0.034],[48,1,102.7,0.035],[60,1,109.4,0.036],[84,1,121.0,0.045],[120,1,141.0,0.05],[144,1,153.0,0.05],[168,1,159.0,0.045],[216,1,160.0,0.04]],
                weight: [[0,0.38,3.2,0.14],[6,0.07,7.3,0.11],[12,0.02,8.9,0.11],[24,-0.06,11.5,0.12],[36,-0.1,13.9,0.13],[48,-0.13,16.1,0.135],[60,-0.15,18.2,0.14],[84,-0.18,23.0,0.15],[120,-0.2,34.0,0.18],[144,-0.15,46.0,0.18],[168,-0.1,53.0,0.16],[216,-0.05,55.0,0.15]],
                head: [[0,1,33.9,0.035],[6,1,42.2,0.03],[12,1,44.9,0.028],[24,1,47.2,0.027],[36,1,48.5,0.027],[48,1,49.3,0.027],[60,1,49.7,0.027]]
            }
        };

        const ADVICE_DATA = [
            { min: 0, max: 0.25, list: ["æ–°ç”Ÿå…’ç¡çœ æ™‚é–“é•·ï¼Œæ³¨æ„ç¡å§¿å®‰å…¨ï¼Œé¿å…è¶´ç¡ã€‚", "æº¢å¥¶æ˜¯æ­£å¸¸çš„ç”Ÿç†ç¾è±¡ï¼Œå–å¥¶å¾Œè¨˜å¾—æ‹å—ï¼Œä½†ä¸å¼·æ±‚ã€‚", "è¦–åŠ›ç™¼å±•åˆæœŸï¼Œé»‘ç™½åœ–å¡æ˜¯ä¸éŒ¯çš„åˆºæ¿€å·¥å…·ã€‚"], title: "0-3å€‹æœˆ æ–°ç”Ÿå…’é©æ‡‰æœŸ" },
            { min: 0.25, max: 0.5, list: ["å°æœ‹å‹é–‹å§‹å˜—è©¦ç¿»èº«å›‰ï¼æ³¨æ„åºŠé‚Šè­·æ¬„ï¼Œé¿å…è·Œè½ã€‚", "è„–å­è®Šç¡¬æŒºäº†ï¼Œå¯ä»¥è¶´è‘—æŠ¬é ­çœ‹çœ‹ä¸–ç•Œã€‚", "å£æ°´è®Šå¤šï¼Œå–œæ­¡åƒæ‰‹ï¼Œé€™æ˜¯å£è…”æœŸçš„æ¢ç´¢è¡¨ç¾ã€‚"], title: "4-6å€‹æœˆ è„–é ¸ç¡¬æŒºæœŸ" },
            { min: 0.5, max: 1, list: ["ä¸ƒåå…«çˆ¬ï¼Œå®¶ä¸­å±éšªç‰©å“è¦æ”¶å¥½ï¼Œæ’åº§åŠ ä¸Šé˜²è­·è“‹ã€‚", "é–‹å§‹é•·ç‰™å¯èƒ½æœƒæ­¡å¿…éœ¸ï¼Œçµ¦äºˆå›ºé½’å™¨èˆ’ç·©ä¸é©ã€‚", "å‰¯é£Ÿå“å¤šæ¨£åŒ–å˜—è©¦ï¼Œå»ºç«‹å…ç–«è€å—æ€§ï¼Œä¸éœ€å»¶å¾Œçµ¦äºˆé«˜è‡´æ•é£Ÿç‰©ã€‚"], title: "7-12å€‹æœˆ åçˆ¬æ¢ç´¢æœŸ" },
            { min: 1, max: 1.5, list: ["å­¸æ­¥æœŸæ–æ–æ™ƒæ™ƒï¼Œå±…å®¶é˜²æ’æªæ–½ä¸èƒ½å°‘ã€‚", "é–‹å§‹æ¨¡ä»¿å¤§äººèªªè©±ï¼Œå¤šè·Ÿå°æœ‹å‹èŠå¤©å¿µç¹ªæœ¬ï¼Œä¸¦è®“å°æœ‹å‹çœ‹å¤§äººç™¼éŸ³æ™‚çš„å£å‹ã€‚", "æ¯åŠå¹´è¨˜å¾—å¸¶å°æœ‹å‹å»å¡—æ°Ÿï¼Œä¿è­·ä¹³ç‰™å¥åº·ã€‚"], title: "1-1.5æ­² å­¸æ­¥æœŸ" },
            { min: 1.5, max: 3, list: ["è™•æ–¼ã€ä¸è¦ä¸è¦ã€çš„å›é€†æœŸï¼Œè©¦è‘—çµ¦äºˆé¸æ“‡é¡Œä»£æ›¿æ˜¯éé¡Œã€‚", "ç²¾åŠ›æ—ºç››ï¼Œå¤šå¸¶å»å…¬åœ’æ”¾é›»ï¼Œæœ‰åŠ©æ–¼æ™šä¸Šç¡çœ ã€‚", "å¯é–‹å§‹å˜—è©¦ç™½å¤©çš„å¦‚å»è¨“ç·´ï¼Œä½†ä¸è¦çµ¦äºˆå¤ªå¤§å£“åŠ›ã€‚"], title: "1.5-3æ­² å¹¼å…’å›é€†æœŸ" },
            { min: 3, max: 5, list: ["é€²å…¥å¹¼å…’åœ’ï¼ŒåˆæœŸå®¹æ˜“æ„Ÿå†’ï¼Œé€™æ˜¯å»ºç«‹å…ç–«ç³»çµ±çš„éç¨‹ã€‚", "æƒ³åƒåŠ›è±å¯Œï¼Œå–œæ­¡æ‰®æ¼”éŠæˆ²ï¼Œé™ªå­©å­æ¼”æˆ²æ˜¯å¾ˆå¥½çš„äº’å‹•ã€‚", "ç²¾ç´°å‹•ä½œé€²æ­¥ä¸­ï¼Œå¯ä»¥ç©ç©æœ¨ã€ç•«ç•«è¨“ç·´å°æ‰‹è‚Œè‚‰ã€‚"], title: "3-5æ­² å­¸é½¡å‰(å¹¼å…’åœ’)" },
            { min: 5, max: 7, list: ["æº–å‚™é€²å…¥å°å­¸ï¼Œå»ºç«‹è¦å¾‹ä½œæ¯èˆ‡æ—©ç¡æ—©èµ·çš„ç¿’æ…£ã€‚", "é–‹å§‹æ›ç‰™ï¼ˆç¬¬ä¸€å¤§è‡¼é½’èŒç™¼ï¼‰ï¼Œè¦å¹«å­©å­ä½¿ç”¨ç‰™ç·šæ¸…æ½”ã€‚", "æ³¨æ„è¦–åŠ›ä¿å¥ï¼Œç”¨çœ¼30åˆ†é˜ä¼‘æ¯10åˆ†é˜ï¼Œå¤šæˆ¶å¤–æ´»å‹•ã€‚"], title: "5-7æ­² å­¸é½¡å‰(å¤§ç­-å°ä¸€)" },
            { min: 7, max: 10, list: ["ç”Ÿé•·å¹³ç©©æœŸï¼Œå¤šåšè·³ç¹©ã€æ‰“çƒç­‰è·³èºæ€§é‹å‹•åˆºæ¿€ç”Ÿé•·æ¿ã€‚", "é¿å…éå¤šå«ç³–é£²æ–™ï¼Œç³–åˆ†æœƒæŠ‘åˆ¶ç”Ÿé•·æ¿€ç´ åˆ†æ³Œã€‚", "åŸ¹é¤Šé–±è®€ç¿’æ…£ï¼Œæ¸›å°‘3Cç”¢å“çš„ä½¿ç”¨æ™‚é–“ã€‚"], title: "7-10æ­² åœ‹å°ä¸­å¹´ç´š" },
            { min: 10, max: 12, gender: 'girl', list: ["å¥³å­©é’æ˜¥æœŸè¼ƒæ—©ï¼Œèƒ¸éƒ¨ç™¼è‚²æ˜¯ç¬¬ä¸€å¾µå…†ï¼Œæé†’å­©å­é€™æ˜¯æ­£å¸¸çš„ã€‚", "ç”Ÿé•·è¡åˆºæœŸé–‹å§‹ï¼Œç¢ºä¿å……è¶³ç¡çœ èˆ‡éˆ£è³ªæ”å–ã€‚", "å¤šé‹å‹•åˆºæ¿€ç”Ÿé•·ï¼Œè·³ç¹©æ˜¯ä¸éŒ¯çš„é¸æ“‡ã€‚"], title: "10-12æ­² é’æ˜¥æœŸåˆæœŸ(å¥³)" },
            { min: 10, max: 12, gender: 'boy', list: ["ç”·å­©ç™¼è‚²è¼ƒæ™šï¼Œæ­¤éšæ®µå„²å‚™èƒ½é‡ï¼Œå¤šåšè² é‡é‹å‹•å­˜éª¨æœ¬ã€‚", "è‹¥çªä¸¸æ˜é¡¯è®Šå¤§ï¼Œä»£è¡¨é’æ˜¥æœŸæ‚„æ‚„é–‹å§‹å›‰ã€‚", "å‡è¡¡é£²é£Ÿï¼Œé¿å…è‚¥èƒ–å½±éŸ¿æ€§æ—©ç†Ÿã€‚"], title: "10-12æ­² å„²å‚™æœŸ(ç”·)" },
            { min: 12, max: 15, gender: 'girl', list: ["æœˆç¶“åˆæ½®é€šå¸¸ç™¼ç”Ÿåœ¨æ­¤éšæ®µï¼Œèº«é«˜å¢åŠ é€Ÿåº¦æœƒæ¸›ç·©ã€‚", "æ³¨æ„éµè³ªæ”å–ï¼ˆå¦‚ç´…è‚‰ã€æ·±ç¶ è”¬èœï¼‰é é˜²è²§è¡€ã€‚", "ä¿æŒè‡ªä¿¡ï¼Œæ¥ç´èº«é«”çš„è®ŠåŒ–ï¼Œå¿ƒç†å¥åº·å¾ˆé‡è¦ã€‚"], title: "12-15æ­² é’æ˜¥æœŸæˆç†Ÿ(å¥³)" },
            { min: 12, max: 15, gender: 'boy', list: ["è®Šè²ã€å–‰çµå‡ºç¾ï¼Œèº«é«˜é€²å…¥é£†é€ŸæœŸï¼Œä¸€å¹´å¯é•·10å…¬åˆ†ä»¥ä¸Šï¼", "é£Ÿé‡å¤§å¢ï¼Œéœ€è£œå……è¶³å¤ è›‹ç™½è³ªèˆ‡éˆ£è³ªï¼Œé¿å…åƒåƒåœ¾é£Ÿç‰©ã€‚", "é‹å‹•é‡å¤§ï¼Œæ³¨æ„é‹å‹•å‚·å®³é˜²è­·ã€‚"], title: "12-15æ­² é’æ˜¥æœŸè¡åˆº(ç”·)" },
            { min: 15, max: 18, gender: 'girl', list: ["ç”Ÿé•·æ¿é€æ¼¸é–‰åˆï¼Œèº«é«˜è¶¨æ–¼å®šå‹ï¼Œç¶­æŒè‰¯å¥½é«”æ…‹ã€‚", "è¦å¾‹é‹å‹•ä¸åƒ…ç¶­æŒèº«æï¼Œä¹Ÿèƒ½é‡‹æ”¾èª²æ¥­å£“åŠ›ã€‚", "å»ºç«‹æ­£ç¢ºçš„èº«é«”æ„è±¡ï¼Œä¸ç›²ç›®è¿½æ±‚éç˜¦ã€‚"], title: "15-18æ­² é’å°‘å¹´(å¥³)" },
            { min: 15, max: 18, gender: 'boy', list: ["ç”Ÿé•·é€Ÿåº¦æ¸›ç·©ï¼Œä½†è‚Œè‚‰é‡æŒçºŒå¢åŠ ï¼Œé«”å‹è®Šå£¯ã€‚", "éƒ¨åˆ†ç”·å­©åˆ°é«˜ä¸­ç•¢æ¥­å‰ä»æœ‰é•·é«˜ç©ºé–“ï¼Œä½œæ¯è¦æ­£å¸¸ã€‚", "åŸ¹é¤Šä¸€ç¨®å–œæ„›çš„é‹å‹•ç¿’æ…£ï¼Œå—ç”¨çµ‚èº«ã€‚"], title: "15-18æ­² é’å°‘å¹´(ç”·)" }
        ];

        // Refined Books with Tags
        const BOOKS_LIBRARY = [
            { ageMin: 0, ageMax: 1, list: [
                { title: "å¥½é¤“çš„æ¯›æ¯›èŸ²", tags: ["ç¶“å…¸","èªçŸ¥"] }, { title: "å°é‡‘é­šé€ƒèµ°äº†", tags: ["è§€å¯Ÿ","ç¶“å…¸"] }, { title: "è¦ªæ„›çš„å‹•ç‰©åœ’", tags: ["ç¿»ç¿»æ›¸","èªçŸ¥"] }, 
                { title: "æŠ±æŠ±", tags: ["æƒ…æ„Ÿ","ç¶“å…¸"] }, { title: "æ£•è‰²çš„ç†Š", tags: ["è‰²å½©","éŸ»å¾‹"] }, { title: "æœˆäº®æ™šå®‰", tags: ["ç¡çœ å„€å¼"] },
                { title: "çŒœçŒœæˆ‘æœ‰å¤šæ„›ä½ ", tags: ["æƒ…æ„Ÿ","ç¶“å…¸"] }, { title: "å°é»ƒé»", tags: ["äº’å‹•","å‰µæ„"] }, { title: "é€™æ˜¯ä»€éº¼ç³»åˆ—", tags: ["èªçŸ¥"] }, 
                { title: "å¸•å¯å¥½æ„›çˆµå£«æ¨‚", tags: ["æœ‰è²","éŸ³æ¨‚"] }, { title: "æ™šå®‰ï¼ŒçŒ©çŒ©", tags: ["å¹½é»˜","è§€å¯Ÿ"] }, { title: "é€™æ˜¯èª°çš„å±è‚¡ï¼Ÿ", tags: ["èªçŸ¥","å¹½é»˜"] },
                { title: "å°æ³¢åœ¨å“ªè£¡ï¼Ÿ", tags: ["ç¿»ç¿»æ›¸","ç¶“å…¸"] }, { title: "æ‘¸ä¸€æ‘¸çœ‹ä¸€çœ‹", tags: ["è§¸è¦º"] }, { title: "å°é›çƒçƒç³»åˆ—", tags: ["æ“ä½œ","ç”Ÿæ´»"] },
                { title: "èº²è²“è²“ (Usborne)", tags: ["è§¸è¦º","æ“ä½œ"] }, { title: "è‰¾æ‘©çš„ä¾¿ç›†", tags: ["ç”Ÿæ´»è‡ªç†"] }, { title: "å¥½é¤“çš„å°è›‡", tags: ["å¹½é»˜","è‰²å½©"] },
                { title: "å°å¯¶å¯¶ç¿»ç¿»æ›¸", tags: ["æ“ä½œ"] }, { title: "æˆ‘çˆ¸çˆ¸/æˆ‘åª½åª½", tags: ["æƒ…æ„Ÿ"] }, { title: "è¦ªä¸€è¦ª", tags: ["äº’å‹•","æƒ…æ„Ÿ"] },
                { title: "è¹¦!", tags: ["å¾‹å‹•"] }, { title: "å¥½é¤“å¥½é¤“çš„é­š", tags: ["è¦–è¦º"] }, { title: "ä¸¹ä¸¹å¯¶å¯¶ç‰ˆ", tags: ["ç”Ÿæ´»"] }
            ]},
            { ageMin: 1, ageMax: 3, list: [
                { title: "å°é›é€›è¶…å¸‚", tags: ["ç”Ÿæ´»","ç´°ç¯€"] }, { title: "é±·é­šæ€•æ€•ç‰™é†«æ€•æ€•", tags: ["ç”Ÿæ´»","å¹½é»˜"] }, { title: "å»è²·æ™šé¤çš„è·¯ä¸Š", tags: ["è§€å¯Ÿ"] }, 
                { title: "æ¯é›è˜¿çµ²å»æ•£æ­¥", tags: ["å¹½é»˜","ç¶“å…¸"] }, { title: "å°æ³¢åœ¨å“ªè£¡", tags: ["ç¿»ç¿»æ›¸"] }, { title: "åŒ…å§†èˆ‡å‡±ç¾…ç³»åˆ—", tags: ["ç´°ç¯€","å‹æƒ…"] }, 
                { title: "é‡ç¸åœ‹", tags: ["æƒ…ç·’","ç¶“å…¸"] }, { title: "å¤åˆ©å’Œå¤æ‹‰", tags: ["åˆ†äº«","ç¾é£Ÿ"] }, { title: "é»é»ç©è²éŸ³", tags: ["äº’å‹•"] },
                { title: "åª½åª½è²·ç¶ è±†", tags: ["è¦ªæƒ…","ç”Ÿæ´»"] }, { title: "èª°å’¬äº†æˆ‘çš„å¤§é¤…", tags: ["æ¨ç†","å‹•ç‰©"] }, { title: "å·´å£«åˆ°ç«™äº†", tags: ["äº¤é€š"] },
                { title: "é€™æ˜¯å…¬è»Š", tags: ["éŸ»å¾‹"] }, { title: "è¬è¬ä½ ä¾†ç•¶æˆ‘çš„å¯¶è²", tags: ["æƒ…æ„Ÿ"] }, { title: "é›²ä¸Šçš„é˜¿é‡Œ", tags: ["ç”Ÿå‘½æ•™è‚²"] },
                { title: "å°ç†Šå­¸æ ¡", tags: ["æ ¡åœ’","å‹æƒ…"] }, { title: "æˆ‘çš„è¡£è£³", tags: ["å‰µæ„"] }, { title: "åŠ æ²¹ï¼è­¦è»Š", tags: ["äº¤é€š"] },
                { title: "å·¥è—¤ç´€å­å°é›ç³»åˆ—", tags: ["ç”Ÿæ´»"] }, { title: "æˆ‘æ˜¯éœ¸ç‹é¾", tags: ["å‹æƒ…","æé¾"] }, { title: "å°ä¼éµæ­ç«è»Š", tags: ["å†’éšª"] },
                { title: "æ®¼æ–—æ‘çš„å¸½å­åº—", tags: ["è·æ¥­"] }, { title: "çƒé´‰éºµåŒ…åº—", tags: ["å®¶åº­"] }, { title: "å°è ¶è±†çš„åºŠ", tags: ["åˆ†äº«"] },
                { title: "ç”Ÿæ°£çš„äºç‘Ÿ", tags: ["æƒ…ç·’"] }, { title: "è¨å­é»‘å¤œçš„å¸­å¥¶å¥¶", tags: ["ææ‡¼"] }
            ]},
            { ageMin: 3, ageMax: 6, list: [
                { title: "ç¥å¥‡æ¨¹å±‹ç³»åˆ—", tags: ["å†’éšª","ç§‘æ™®"] }, { title: "100å±¤æ¨“çš„å®¶", tags: ["è§€å¯Ÿ","æ•¸æ•¸"] }, { title: "ç”Ÿæ°£ç‹å­", tags: ["æƒ…ç·’","æºé€š"] },
                { title: "æ„›å“­å…¬ä¸»", tags: ["æƒ…ç·’"] }, { title: "å±å±åµæ¢ç¹ªæœ¬", tags: ["è§€å¯Ÿ","æ¨ç†"] }, { title: "é•·è¥ªçš®çš®", tags: ["å†’éšª"] },
                { title: "çˆºçˆºä¸€å®šæœ‰è¾¦æ³•", tags: ["å‰µæ„","æƒœç‰©"] }, { title: "å¤§è¡›ï¼Œä¸å¯ä»¥", tags: ["è¦çŸ©"] }, { title: "ä¸ç¡è¦ºä¸–ç•Œå† è»", tags: ["æƒ³åƒ"] },
                { title: "é€™æ˜¯æˆ‘çš„ï¼", tags: ["åˆ†äº«"] }, { title: "å‹‡æ•¢å°ç«è»Š", tags: ["å‹‡æ°£"] }, { title: "æœ±ç‘ç¦çš„æ¸¸æ³³èª²", tags: ["æˆé•·"] },
                { title: "é‡è²“è»åœ˜", tags: ["å¹½é»˜","å¾Œæœ"] }, { title: "æ´»äº†ä¸€ç™¾è¬æ¬¡çš„è²“", tags: ["ç”Ÿå‘½","æ„›"] }, { title: "èš¯èš“çš„æ—¥è¨˜", tags: ["å¹½é»˜"] },
                { title: "è Ÿç­†å°é»‘", tags: ["åˆä½œ","å‰µæ„"] }, { title: "æ®¼æ–—æ‘çš„éºµåŒ…åº—", tags: ["è·æ¥­"] }, { title: "å°æˆ¿å­", tags: ["ç’°å¢ƒ"] },
                { title: "è³£å¸½å­", tags: ["å¹½é»˜"] }, { title: "å¤åˆ©å’Œå¤æ‹‰", tags: ["åˆä½œ"] }, { title: "æ£®æ—100å±¤æ¨“çš„å®¶", tags: ["è§€å¯Ÿ"] },
                { title: "åœ°ä¸‹100å±¤æ¨“çš„å®¶", tags: ["è§€å¯Ÿ"] }, { title: "æµ·åº•100å±¤æ¨“çš„å®¶", tags: ["è§€å¯Ÿ"] }, { title: "å¤©ç©º100å±¤æ¨“çš„å®¶", tags: ["è§€å¯Ÿ"] },
                { title: "åˆ°åº•åœ¨æ’ä»€éº¼ï¼Ÿ", tags: ["è§€å¯Ÿ"] }, { title: "ç¬¬ä¸€æ¬¡ä¸Šè¡—è²·æ±è¥¿", tags: ["æˆé•·"] }, { title: "ç¾çš„ç¦®ç‰©", tags: ["ç”Ÿå‘½æ•™è‚²"] }
            ]},
            { ageMin: 6, ageMax: 10, list: [
                { title: "ç¥å¥‡æ¨¹å±‹", tags: ["æ©‹æ¨‘æ›¸","å†’éšª"] }, { title: "æ€ªå‚‘ä½ç¾…åŠ›", tags: ["å¹½é»˜","å‰µæ„"] }, { title: "å°‹å¯¶è¨˜ç³»åˆ—", tags: ["çŸ¥è­˜","æ¼«ç•«"] },
                { title: "æ™´å¤©é›¨å¤©ï¼Œæœ‰æ™‚é‚„æœƒä¸‹è±¬", tags: ["æƒ³åƒ"] }, { title: "å›å‰ä¸Šå°å­¸", tags: ["æ ¡åœ’","ç”Ÿæ´»"] }, { title: "ç¾…é”çˆ¾ç³»åˆ—", tags: ["å¥‡å¹»","ç¶“å…¸"] },
                { title: "ç¥å¥‡æŸ‘ä»”åº—", tags: ["å¥‡å¹»","å“æ ¼"] }, { title: "ç”¨é»å¿ƒå­¸æ ¡", tags: ["å¹½é»˜","èªæ–‡"] }, { title: "å±å±åµæ¢è®€æœ¬", tags: ["æ¨ç†"] },
                { title: "ç§‘å­¸å¯¦é©—ç‹", tags: ["ç§‘æ™®","æ¼«ç•«"] }, { title: "å¦–æ€ªæ‰‹éŒ¶", tags: ["å¹½é»˜"] }, { title: "éœ²éœ²å’Œæ‹‰æ‹‰", tags: ["å‹æƒ…","çƒ¹é£ª"] },
                { title: "é»‘è²“é­¯é“å¤«", tags: ["å†’éšª","æˆé•·"] }, { title: "çª—é‚Šçš„å°è³è³", tags: ["æ•™è‚²","ç¶“å…¸"] }, { title: "å¤ç¶ è’‚çš„ç¶²", tags: ["å‹æƒ…","ç”Ÿå‘½"] },
                { title: "å¤§åµæ¢å¥ˆç‰¹", tags: ["æ¨ç†"] }, { title: "å­—çš„ç«¥è©±", tags: ["èªæ–‡"] }, { title: "æ™´ç©ºå°ä¾éƒ", tags: ["å¥‡å¹»","æ–‡å­¸"] },
                { title: "ç«é¾å®¶åº­æ•…äº‹é›†", tags: ["å¹½é»˜"] }, { title: "ä¸ä¸æ­·éšªè¨˜", tags: ["å†’éšª","ç¶“å…¸"] }, { title: "å°é ­ç›®å„ªç‘ª", tags: ["åŸæ°‘","å¥‡å¹»"] },
                { title: "å¯èƒ½å°å­¸çš„æ­·å²ä»»å‹™", tags: ["æ­·å²","ç©¿è¶Š"] }, { title: "æ™¨è®€10åˆ†é˜", tags: ["é–±è®€"] }, { title: "è¥¿éŠè¨˜(å…’ç«¥ç‰ˆ)", tags: ["ç¶“å…¸"] },
                { title: "ä¸‰åœ‹æ¼”ç¾©(å…’ç«¥ç‰ˆ)", tags: ["ç¶“å…¸","æ­·å²"] }, { title: "ç¦çˆ¾æ‘©æ–¯(å…’ç«¥ç‰ˆ)", tags: ["æ¨ç†"] }, { title: "äºæ£®ç¾…è˜‹(å…’ç«¥ç‰ˆ)", tags: ["æ¨ç†"] }
            ]},
            { ageMin: 10, ageMax: 18, list: [
                { title: "å“ˆåˆ©æ³¢ç‰¹", tags: ["å¥‡å¹»","ç¶“å…¸"] }, { title: "æ³¢è¥¿å‚‘å…‹æ£®", tags: ["ç¥è©±","å†’éšª"] }, { title: "ä¿®ç…‰", tags: ["å¥‡å¹»","æ±æ–¹"] },
                { title: "è²“æˆ°å£«", tags: ["å†’éšª","å‹•ç‰©"] }, { title: "é£¢é¤“éŠæˆ²", tags: ["åçƒæ‰˜é‚¦"] }, { title: "å°ç‹å­", tags: ["å“²å­¸","ç¶“å…¸"] },
                { title: "ç¬¬åå››é“é–€", tags: ["é©šæ‚š","å¥‡å¹»"] }, { title: "å°‘å¹´å°æ¨¹ä¹‹æ­Œ", tags: ["è‡ªç„¶","æˆé•·"] }, { title: "é‡‘åº¸æ­¦ä¿ å°èªª", tags: ["æ­¦ä¿ ","ç¶“å…¸"] },
                { title: "é­”æˆ’", tags: ["å¥‡å¹»","å²è©©"] }, { title: "äºæ£®ç¾…è˜‹", tags: ["æ¨ç†"] }, { title: "ç¦çˆ¾æ‘©æ–¯", tags: ["æ¨ç†"] },
                { title: "æš®å…‰ä¹‹åŸ", tags: ["æ„›æƒ…","å¥‡å¹»"] }, { title: "ç§»å‹•è¿·å®®", tags: ["ç§‘å¹»","å†’éšª"] }, { title: "åˆ†æ­§è€…", tags: ["ç§‘å¹»"] },
                { title: "å·æ›¸è³Š", tags: ["æ­·å²","äººæ€§"] }, { title: "å¥‡è¹Ÿç”·å­©", tags: ["å‹µå¿—","æ ¡åœ’"] }, { title: "åˆ¥ç›¸ä¿¡ä»»ä½•äºº", tags: ["æ‡¸ç–‘"] },
                { title: "è§£æ†‚é›œè²¨åº—", tags: ["æº«é¦¨","æ‡¸ç–‘"] }, { title: "æ‰‹æ–§ç”·å­©", tags: ["æ±‚ç”Ÿ","å†’éšª"] }, { title: "è¨±é¡˜æ¨¹", tags: ["å¹½é»˜","è‡ªç„¶"] },
                { title: "ç‰§ç¾Šå°‘å¹´å¥‡å¹»ä¹‹æ—…", tags: ["å“²å­¸","æ—…è¡Œ"] }, { title: "æ·±å¤œé£Ÿå ‚", tags: ["ç”Ÿæ´»","æ¼«ç•«"] }, { title: "é¾é¨ä¿ ", tags: ["å¥‡å¹»"] },
                { title: "åœ°æµ·å‚³èªª", tags: ["å¥‡å¹»","ç¶“å…¸"] }, { title: "é¢¨ä¹‹å½±", tags: ["æ‡¸ç–‘","æ–‡å­¸"] }
            ]}
        ];

        // Refined Games with Tags (BoardSheep Style + User Requested)
        const GAMES_LIBRARY = [
            { ageMin: 0, ageMax: 2, list: [
                { title: "ç–Šç–Šæ¯", tags: ["æ‰‹çœ¼å”èª¿"] }, { title: "è»Ÿç©æœ¨", tags: ["è§¸è¦º"] }, { title: "å½¢ç‹€é…å°ç›’", tags: ["èªçŸ¥","ç²¾ç´°å‹•ä½œ"] },
                { title: "è§¸è¦ºçƒ", tags: ["æ„Ÿè¦ºçµ±åˆ"] }, { title: "å¸ƒæ›¸", tags: ["è¦–è¦º","è§¸è¦º"] }, { title: "æ•²æ“Šæ¨‚å™¨", tags: ["è½è¦º","ç¯€å¥"] },
                { title: "æ»¾çƒå¡”", tags: ["è¿½è¦–","å› æœ"] }, { title: "æ¨æ‹‰ç©å…·", tags: ["å¤§å‹•ä½œ"] }, { title: "éŸ³æ¨‚éˆ´", tags: ["å®‰æ’«"] },
                { title: "å…­é¢è²å…‰ç›’", tags: ["æ¢ç´¢"] }, { title: "æ‰‹æŠ“æ¿æ‹¼åœ–", tags: ["é…å°"] }, { title: "æ´—æ¾¡æ›¸", tags: ["ç”Ÿæ´»"] },
                { title: "å®‰æ’«å·¾", tags: ["å®‰æ’«"] }, { title: "æ³¢æ³¢çƒ", tags: ["è§¸è¦º"] }, { title: "å¤šåŠŸèƒ½å¥åŠ›æ¶", tags: ["å¤§å‹•ä½œ"] },
                { title: "ç¬¬ä¸€å¥—æ¡ŒéŠ-å°æœåœ’", tags: ["HABA","åˆä½œ"] }, { title: "æ™šå®‰å°æœˆäº®", tags: ["HABA","é…å°"] }
            ]},
            { ageMin: 2, ageMax: 4, list: [
                { title: "ä¸‰éš»å°è±¬", tags: ["SmartGames","é‚è¼¯"] }, { title: "æ¨æ¨æ¾é¼ ", tags: ["SmartGames","è¦åŠƒ"] }, { title: "å½©è™¹å°é¦¬", tags: ["é‹æ°£","æ“²éª°"] },
                { title: "åŸå¸‚å°æ—…è¡Œ", tags: ["æ‰‹ç‰Œç®¡ç†","é¡è‰²"] }, { title: "å‹•ç‰©è®Šè£ç§€", tags: ["é‚è¼¯","é…å°"] }, { title: "è«¾äºæ–¹èˆŸ", tags: ["å¹³è¡¡","æ‰‹çœ¼å”èª¿"] },
                { title: "æ‹”æ¯›é‹å‹•æœƒ", tags: ["è¨˜æ†¶","ç¶“å…¸"] }, { title: "é‡£é­šéŠæˆ²", tags: ["HABA","æ‰‹çœ¼å”èª¿"] }, { title: "æ¨‚é«˜å¾—å¯¶", tags: ["å»ºæ§‹","å‰µæ„"] },
                { title: "è¨˜æ†¶ç¿»ç‰Œ", tags: ["è¨˜æ†¶"] }, { title: "é†œå¨ƒå¨ƒ", tags: ["åæ‡‰","è§€å¯Ÿ"] }, { title: "å“†å¯¶ (Dobble)", tags: ["åæ‡‰","è§€å¯Ÿ"] },
                { title: "ä¼éµç ´å†°", tags: ["æ‰‹éƒ¨æ§åˆ¶"] }, { title: "å¹³è¡¡ä»™äººæŒ", tags: ["å¹³è¡¡"] }, { title: "æœ¨è£½åˆ‡åˆ‡æ¨‚", tags: ["è§’è‰²æ‰®æ¼”"] },
                { title: "ç£åŠ›ç‰‡", tags: ["å»ºæ§‹"] }, { title: "é»åœŸå·¥å…·çµ„", tags: ["å‰µé€ "] }, { title: "å‹•ç‰©ç–Šç–Šæ¨‚ (Tier auf Tier)", tags: ["HABA","å¹³è¡¡"] },
                { title: "çƒé´‰æœåœ’", tags: ["HABA","åˆä½œ"] }, { title: "é‡£é´¨å­", tags: ["å°ˆæ³¨"] }
            ]},
            { ageMin: 4, ageMax: 7, list: [
                { title: "è¶…ç´šçŠ€ç‰›", tags: ["HABA","å¹³è¡¡"] }, { title: "ç£çŸ³é­”æ³•è¿·å®®", tags: ["è¨˜æ†¶","å‰µæ„"] }, { title: "ç…å­å‰ªé«®å¤§å†’éšª", tags: ["åˆä½œ","è¨˜æ†¶"] },
                { title: "ç‹ç‹¸åœ¨å“ªè£¡", tags: ["åˆä½œ","æ¨ç†"] }, { title: "çŸ³å™¨æ™‚ä»£å…’ç«¥ç‰ˆ", tags: ["è¨˜æ†¶","è³‡æº"] }, { title: "é–ƒéˆå¿«æ‰‹", tags: ["åæ‡‰","é‚è¼¯"] },
                { title: "ç¡çš‡å", tags: ["é‹æ°£","ç°¡å–®ç­–ç•¥"] }, { title: "å¡å¡é Œ(å…’ç«¥ç‰ˆ)", tags: ["ç­–ç•¥","è§€å¯Ÿ"] }, { title: "å¦™èªèªªæ›¸äºº", tags: ["è¡¨é”","æƒ³åƒ"] },
                { title: "å¾·åœ‹å¿ƒè‡Ÿç—…", tags: ["åæ‡‰","åŠ æ³•"] }, { title: "å‚³æƒ…ç•«æ„", tags: ["ç•«ç•«","è¡¨é”"] }, { title: "é«’å°è±¬", tags: ["ç­–ç•¥","é‹æ°£"] },
                { title: "èª°æ˜¯ç‰›é ­ç‹", tags: ["æ•¸å­—","é‚è¼¯"] }, { title: "å†°é…·ä¼éµ", tags: ["æŠ€å·§","å½ˆæŒ‡"] }, { title: "å°ç™½ä¸–ç´€", tags: ["å†’éšª"] },
                { title: "è·³è·³çŒ´å¤§ä½œæˆ°", tags: ["æ‰‹éƒ¨æ§åˆ¶"] }, { title: "ä¼æœ¨é”äºº", tags: ["æ‰‹éƒ¨æ§åˆ¶"] }, { title: "å¿«æ‰‹ç–Šæ¯", tags: ["åæ‡‰","ç«¶é€Ÿ"] },
                { title: "æ¨å€’æåŸº", tags: ["ç­–ç•¥","å¿ƒæ©Ÿ"] }, { title: "å°ç¾Šèº²è²“è²“", tags: ["HABA","è¨˜æ†¶"] }, { title: "é›åŒé´¨æ¶", tags: ["ç­–ç•¥"] },
                { title: "é¾ä¹‹åæ¯", tags: ["HABA","æ”¶é›†"] }, { title: "èŒçŠ¬å°å°ç¢°", tags: ["è§€å¯Ÿ","åæ‡‰"] }, { title: "æŠ«è–©å¤§äº¨", tags: ["æ•¸å­¸","é€Ÿåº¦"] },
                { title: "ç™¾è®Šæ–¹å¡Š", tags: ["ç›Šæ™º","ç©ºé–“"] }
            ]},
            { ageMin: 7, ageMax: 12, list: [
                { title: "å¤šç±³è«¾ç‹åœ‹", tags: ["ç­–ç•¥","æ¿å¡Š"] }, { title: "èŸ²èŸ²ç‡’çƒ¤æ´¾å°", tags: ["é‹æ°£","æ•¸å­¸"] }, { title: "ç‰™è²·åŠ ", tags: ["ç«¶é€Ÿ","é‹æ°£"] },
                { title: "ç±³å¯¶é¦¬æˆ²åœ˜", tags: ["å‹•ä½œ","ç–Šç–Šæ¨‚"] }, { title: "å…¨åŠ›è¡å»", tags: ["æ‰‹ç‰Œç®¡ç†","æ•¸å­—"] }, { title: "æ´å¯Ÿæ€æ©Ÿ", tags: ["è§€å¯Ÿ","çŒœæ¸¬"] },
                { title: "å¸½å­æˆ²æ³•", tags: ["åæ‡‰","è§€å¯Ÿ"] }, { title: "ä¹¾æ¯", tags: ["è¨˜æ†¶","å¿ƒæ©Ÿ"] }, { title: "é£›èºé­”ç›œåœ˜", tags: ["åˆä½œ","å³æ™‚"] },
                { title: "ç¥å¥ˆå·å­¸è‹‘", tags: ["æ”¶é›†","ç¾æ„Ÿ"] }, { title: "å¤¢æƒ³å®¶åœ’", tags: ["è¦åŠƒ","å®¶åº­"] }, { title: "æ˜Ÿçƒé˜²è¡›è€…", tags: ["ç­–ç•¥","è¦åŠƒ"] },
                { title: "å·«è¡“å­¸é™¢", tags: ["é€£é–","æ”¶é›†"] }, { title: "å¡å¡é Œ", tags: ["ç­–ç•¥","æ¿å¡Šæ”¾ç½®"] }, { title: "æ‹‰å¯†", tags: ["é‚è¼¯","æ•¸å­—"] },
                { title: "çŸ®äººç¤¦å‘", tags: ["é™£ç‡Ÿ","å¿ƒæ©Ÿ"] }, { title: "ç’€ç’¨å¯¶çŸ³", tags: ["è³‡æºç®¡ç†","ç­–ç•¥"] }, { title: "ç¥¨å‹™å¤§å¸«", tags: ["è¦åŠƒ","ç­–ç•¥"] },
                { title: "çŠ¯äººåœ¨è·³èˆ", tags: ["æ¨è£¡","æ´¾å°"] }, { title: "ç”¢åœ°ç›´é€", tags: ["ç¶“ç‡Ÿ"] }, { title: "é§±é§å¤§è³½", tags: ["é‹æ°£","åšå¥•"] },
                { title: "éµé“ä»»å‹™", tags: ["è¦åŠƒ"] }, { title: "çˆ†ç‚¸è²“", tags: ["æ´¾å°","é‹æ°£"] }, { title: "èŠ±ç£šç‰©èª", tags: ["ç¾æ„Ÿ","ç­–ç•¥"] },
                { title: "ä¸ƒå¤§å¥‡è¹Ÿ", tags: ["æ–‡æ˜","è¼ªæŠ½"] }, { title: "æƒ…æ›¸", tags: ["æ¨ç†","é‹æ°£"] }, { title: "å¯Œé¥’ä¹‹åŸ", tags: ["è§’è‰²èƒ½åŠ›","å»ºè¨­"] },
                { title: "å°åŠ å¯¶è—", tags: ["é¢¨éšªè©•ä¼°"] }, { title: "çš‡è¼¿çˆ­éœ¸", tags: ["ç‰Œåº«æ§‹ç¯‰"] }, { title: "çŸ³å™¨æ™‚ä»£", tags: ["å·¥äººæ”¾ç½®"] },
                { title: "å°ä¸–ç•Œ", tags: ["å€åŸŸæ§åˆ¶"] }, { title: "å¡å¦å³¶", tags: ["äº¤æ˜“","å»ºè¨­"] }, { title: "ç˜Ÿç–«å±æ©Ÿ", tags: ["åˆä½œ"] },
                { title: "æ­¥æ­¥ç‚ºç‡Ÿ", tags: ["ç­–ç•¥","åœå µ"] }, { title: "é»‘ç™½æ£‹", tags: ["ç¶“å…¸","ç­–ç•¥"] }, { title: "åºåˆ—å–µå–µ", tags: ["é‹æ°£","ç­–ç•¥"] }
            ]},
            { ageMin: 12, ageMax: 18, list: [
                { title: "ä¸‰åœ‹å¾—å¿—", tags: ["ä¸‰äºº","ç­–ç•¥"] }, { title: "è²“å³¶å¥‡ç·£", tags: ["æ¿å¡Š","ç­–ç•¥"] }, { title: "ç†Šç†Šå…¬åœ’", tags: ["æ¿å¡Š","æ‹¼æ”¾"] },
                { title: "å¹³è¡¡ç¸", tags: ["å¹³è¡¡","ç§‘æŠ€"] }, { title: "æ³¢å¤šé»å„", tags: ["ç­–ç•¥","ç¶“ç‡Ÿ"] },
                { title: "å¡å¦å³¶", tags: ["ç­–ç•¥","äº¤æ˜“"] }, { title: "ç˜Ÿç–«å±æ©Ÿ", tags: ["åˆä½œ","ç­–ç•¥"] },
                { title: "å¦™èªèªªæ›¸äºº", tags: ["è¯æƒ³"] }, { title: "æˆªç¢¼æˆ°", tags: ["åœ˜éšŠ","æ¨ç†"] },
                { title: "è“‹äºè¨ˆåŠƒ", tags: ["é‡åº¦ç­–ç•¥"] }, { title: "é®åˆ€æˆ°çˆ­", tags: ["å€åŸŸæ§åˆ¶"] }, { title: "é›»åŠ›å…¬å¸", tags: ["ç«¶æ¨™","ç¶“ç‡Ÿ"] },
                { title: "è¾²å®¶æ¨‚", tags: ["å·¥äººæ”¾ç½®"] }, { title: "ç¥ç§˜å¤§åœ°", tags: ["å€åŸŸæ§åˆ¶"] },
                { title: "æ©Ÿå¯†ä»£è™Ÿ", tags: ["è¯æƒ³","æ´¾å°"] }, { title: "é˜¿ç“¦éš†", tags: ["é™£ç‡Ÿ","é‚è¼¯"] }, { title: "å±±ä¸­å°å±‹", tags: ["åŠ‡æœ¬","å†’éšª"] },
                { title: "å¤§è¥¿éƒ¨ä¹‹è·¯", tags: ["ç­–ç•¥"] }, { title: "æ®–æ°‘ç«æ˜Ÿ", tags: ["å¼•æ“æ§‹ç¯‰"] },
                { title: "ç«ç·šä»»å‹™", tags: ["åˆä½œ","æ•‘æ´"] }, { title: "ç‚¸å½ˆå‰‹æ˜Ÿ", tags: ["åˆä½œ","æ¨ç†"] }, { title: "å‹ƒæ ¹åœ°åŸå ¡", tags: ["ç­–ç•¥","éª°å­"] },
                { title: "æ–¹èˆŸå‹•ç‰©åœ’", tags: ["ç­–ç•¥","ç¶“ç‡Ÿ"] }, { title: "é™æ™‚è§£é–", tags: ["è§£è¬","åˆä½œ"] }, { title: "ä¸–ç•Œå¥‡è§€", tags: ["æ¿å¡Š","å»ºè¨­"] },
                { title: "é¾ç¿¼ç¿±ç¿”", tags: ["ç­–ç•¥","æ”¶é›†"] }, { title: "é­”ç‰©è¨ä¼éšŠ", tags: ["åˆä½œ","æˆ°é¬¥"] }, { title: "éŠæƒ¡åœ’", tags: ["è«‡åˆ¤","ç­–ç•¥"] },
                { title: "å“¥å‰æ‹‰æ±äº¬è¡çª", tags: ["å°æˆ°","ç ´å£"] }, { title: "å¹½æ¸¯è¿·åŸ", tags: ["å†’éšª","æˆ°å½¹"] }
            ]}
        ];

        const DATA_VACCINES = [
            { ageMo: 0, name: "Bå‹è‚ç‚ç–«è‹—(ç¬¬ä¸€åŠ‘)" }, { ageMo: 1, name: "Bå‹è‚ç‚ç–«è‹—(ç¬¬äºŒåŠ‘)" }, { ageMo: 2, name: "13åƒ¹çµåˆå‹è‚ºç‚éˆçƒèŒç–«è‹—(ç¬¬ä¸€åŠ‘)" }, { ageMo: 2, name: "äº”åˆä¸€ç–«è‹—(ç¬¬ä¸€åŠ‘)" }, { ageMo: 2, name: "å£æœè¼ªç‹€ç—…æ¯’ç–«è‹—(ç¬¬ä¸€åŠ‘/è‡ªè²»)" }, { ageMo: 2, name: "è…¸ç—…æ¯’71å‹ç–«è‹—(ç¬¬ä¸€åŠ‘/è‡ªè²»)" }, { ageMo: 2, name: "Bå‹è…¦è†œç‚é›™çƒèŒç–«è‹—(ç¬¬ä¸€åŠ‘/è‡ªè²»)" },
            { ageMo: 4, name: "13åƒ¹çµåˆå‹è‚ºç‚éˆçƒèŒç–«è‹—(ç¬¬äºŒåŠ‘)" }, { ageMo: 4, name: "äº”åˆä¸€ç–«è‹—(ç¬¬äºŒåŠ‘)" }, { ageMo: 4, name: "å£æœè¼ªç‹€ç—…æ¯’ç–«è‹—(ç¬¬äºŒåŠ‘/è‡ªè²»)" }, { ageMo: 4, name: "è…¸ç—…æ¯’71å‹ç–«è‹—(ç¬¬äºŒåŠ‘/è‡ªè²»)" }, { ageMo: 4, name: "Bå‹è…¦è†œç‚é›™çƒèŒç–«è‹—(ç¬¬äºŒåŠ‘/è‡ªè²»)" },
            { ageMo: 6, name: "Bå‹è‚ç‚ç–«è‹—(ç¬¬ä¸‰åŠ‘)" }, { ageMo: 6, name: "äº”åˆä¸€ç–«è‹—(ç¬¬ä¸‰åŠ‘)" }, { ageMo: 6, name: "æµæ„Ÿç–«è‹—(æ¯å¹´10æœˆ,åˆæ¬¡æ‰“2åŠ‘)" },
            { ageMo: 12, name: "éº»ç–¹è…®è…ºç‚å¾·åœ‹éº»ç–¹æ··åˆç–«è‹—(ç¬¬ä¸€åŠ‘)" }, { ageMo: 12, name: "æ°´ç—˜ç–«è‹—(ç¬¬ä¸€åŠ‘)" }, { ageMo: 12, name: "13åƒ¹çµåˆå‹è‚ºç‚éˆçƒèŒç–«è‹—(ç¬¬ä¸‰åŠ‘)" }, { ageMo: 12, name: "è…¸ç—…æ¯’71å‹ç–«è‹—(ç¬¬ä¸‰åŠ‘/è‡ªè²»)" }, { ageMo: 12, name: "Bå‹è…¦è†œç‚é›™çƒèŒç–«è‹—(ç¬¬ä¸‰åŠ‘/è‡ªè²»)" },
            { ageMo: 15, name: "æ—¥æœ¬è…¦ç‚ç–«è‹—(ç¬¬ä¸€åŠ‘)" },
            { ageMo: 18, name: "äº”åˆä¸€ç–«è‹—(ç¬¬å››åŠ‘)" }, { ageMo: 18, name: "Aå‹è‚ç‚ç–«è‹—(ç¬¬ä¸€åŠ‘)" },
            { ageMo: 27, name: "æ—¥æœ¬è…¦ç‚ç–«è‹—(ç¬¬äºŒåŠ‘)" }, { ageMo: 27, name: "Aå‹è‚ç‚ç–«è‹—(ç¬¬äºŒåŠ‘)" },
            { ageMo: 60, name: "éº»ç–¹è…®è…ºç‚å¾·åœ‹éº»ç–¹æ··åˆç–«è‹—(ç¬¬äºŒåŠ‘)" }, { ageMo: 60, name: "å››åˆä¸€ç–«è‹—(å–®ä¸€åŠ‘)" }, { ageMo: 60, name: "æ°´ç—˜ç–«è‹—(ç¬¬äºŒåŠ‘/è‡ªè²»)" }
        ];

        const DATA_DEVELOPMENT = [
            { 
                minMo: 0, maxMo: 2, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘è¶´è‘—æ™‚ï¼Œé ­èƒ½ç¨å¾®æŠ¬èµ·é›¢é–‹åºŠé¢",
                    "ã€ç´°å‹•ä½œã€‘æ‰‹æŒå¤§éƒ¨åˆ†æ™‚é–“å¼µé–‹ï¼Œä¸ç·Šæ¡æ‹³",
                    "ã€è¦–è¦ºã€‘çœ¼ç›æœƒæ³¨è¦–äººè‡‰æˆ–è·Ÿéš¨ç§»å‹•çš„ç‰©é«”ï¼ˆå¦‚ç´…çƒï¼‰",
                    "ã€è½è¦ºã€‘è½åˆ°çªç„¶çš„è²éŸ³æœƒåš‡ä¸€è·³ã€çœ¨çœ¼æˆ–åœæ­¢å‹•ä½œ",
                    "ã€ç¤¾æœƒã€‘è¢«é€—å¼„æ™‚æœƒæœ‰åæ‡‰ï¼ˆä¸ä¸€å®šæ˜¯ç¬‘ï¼‰"
                ] 
            },
            { 
                minMo: 2, maxMo: 4, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘æŠ±ç›´æ™‚ï¼Œé ¸éƒ¨ç¨å¾®ç¡¬æŒºï¼Œé ­èƒ½è±ç›´",
                    "ã€ç²—å‹•ä½œã€‘è¶´è‘—æ™‚ï¼Œå‰è‡‚èƒ½æ”¯æ’å°‡èƒ¸éƒ¨æŠ¬èµ·",
                    "ã€ç´°å‹•ä½œã€‘æœƒæ®å‹•æ‰‹å»ç¢°è§¸çœ¼å‰çš„ç©å…·",
                    "ã€ç´°å‹•ä½œã€‘æ‰‹èƒ½æŠ“æ¡æ”¾å…¥æŒå¿ƒçš„æ–éˆ´",
                    "ã€èªè¨€ã€‘æœƒç™¼å‡ºã€Œé˜¿ã€å—šã€ç­‰æ¯éŸ³",
                    "ã€ç¤¾æœƒã€‘çœ‹åˆ°ç…§é¡§è€…æœƒè¡¨ç¾å‡ºé«˜èˆˆçš„æ¨£å­ï¼Œé€—å¼„æœƒç¬‘"
                ] 
            },
            { 
                minMo: 4, maxMo: 6, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘æœƒç¿»èº«ï¼ˆç”±ä»°èººè®Šè¶´ï¼Œæˆ–ç”±è¶´è®Šä»°èººï¼‰",
                    "ã€ç²—å‹•ä½œã€‘ç›´ç«‹æŠ±æ™‚ï¼Œè…³æœƒæƒ³è¦ç”¨åŠ›è¹¬",
                    "ã€ç´°å‹•ä½œã€‘å…©æ‰‹æœƒäº’æ¡ï¼Œæˆ–ç©å¼„è‡ªå·±çš„æ‰‹æŒ‡",
                    "ã€ç´°å‹•ä½œã€‘æœƒä¼¸æ‰‹æŠ“çœ¼å‰çš„æ±è¥¿æ”¾å…¥å£ä¸­",
                    "ã€èªè¨€ã€‘æœƒè½‰é ­å°‹æ‰¾è²æº",
                    "ã€ç¤¾æœƒã€‘çœ¼ç›çœ‹ä¸è¦‹åª½åª½ï¼ˆä¸»è¦ç…§é¡§è€…ï¼‰æœƒå“­å«"
                ] 
            },
            { 
                minMo: 6, maxMo: 9, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘è¶´è‘—æ™‚å¯ç”¨æ‰‹è‚˜æˆ–æ‰‹æŒæ”¯æ’æŠ¬èµ·ä¸ŠåŠèº«ï¼Œé ­éƒ¨ç©©å®š",
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥ç¿»èº«ï¼ˆè‹¥ä¸æœƒç¿»èº«ï¼Œéœ€ç¢ºèªä¸å°ç¨±é ¸éƒ¨å¼µåŠ›åå°„æ˜¯å¦æ¶ˆå¤±ï¼‰",
                    "ã€ç²—å‹•ä½œã€‘ç¨å¾®è¼”åŠ©ä¸‹å¯ç¶­æŒåå§¿ï¼Œèº«é«”ä¸éåº¦å‰å‚¾",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¯ä»¥ç”¨é›™æ‰‹æ¡è‘—ç‰©å“ï¼ˆå¦‚å¥¶ç“¶ï¼‰",
                    "ã€ç²¾ç´°å‹•ä½œã€‘æ‰‹å¸•è“‹è‡‰æ™‚ï¼Œæœƒç”¨å–®æ‰‹æ‹¿é–‹",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¤§æ‹‡æŒ‡å¯ä¼¸ç›´å¤–å±•ï¼Œä¸æœƒæŒçºŒå…§ç¸®æ¡æ‹³",
                    "ã€èªçŸ¥èªè¨€ã€‘å‘¼å–Šåå­—æˆ–å°åæœ‰åæ‡‰",
                    "ã€èªçŸ¥èªè¨€ã€‘æ‹¿ç©å…·è·¨éä¸­ç·šç§»å‹•ï¼Œçœ¼çƒæœƒè¿½è¦–ä¸¦ä¼¸æ‰‹æ‹¿",
                    "ã€ç¤¾æœƒã€‘é€—å¼„æ™‚æœƒç¬‘å¾—å¾ˆé–‹å¿ƒ"
                ] 
            },
            { 
                minMo: 9, maxMo: 12, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘èƒ½è‡ªå·±æ”¾æ‰‹åç©©è‡³å°‘1åˆ†é˜",
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥å¾€å‰çˆ¬è¡Œè‡³å°‘30å…¬åˆ†ï¼Œæˆ–ç”±èºº/è¶´å§¿å‹¢è‡ªå·±åèµ·",
                    "ã€ç²—å‹•ä½œã€‘æ‰¶è‘—è…‹ä¸‹æ”¯æ’æ™‚ï¼Œè…³èƒ½ç«™å¾—å¾ˆæŒº",
                    "ã€ç²¾ç´°å‹•ä½œã€‘æœƒå°‡ç©å…·ç”±ä¸€æ‰‹æ›è‡³å¦ä¸€æ‰‹ï¼ˆä¸æ‰è½ï¼‰",
                    "ã€ç²¾ç´°å‹•ä½œã€‘æœƒç”¨é£ŸæŒ‡æˆ³æ´æˆ–æŒ‰æŒ‰éˆ•",
                    "ã€ç²¾ç´°å‹•ä½œã€‘èƒ½ä»¥æ‹‡æŒ‡èˆ‡é£ŸæŒ‡(ä¸­æŒ‡)å°æ¡æŠ“å–å°ç©æœ¨",
                    "ã€èªçŸ¥èªè¨€ã€‘æœƒä¸€æ‰‹å„æ‹¿ä¸€å€‹ç©å…·äº’ç›¸æ•²æ‰“",
                    "ã€èªçŸ¥èªè¨€ã€‘ç©å…·æ‰è½è¦–ç·šå¤–ï¼Œçœ¼ç¥æœƒå»å°‹æ‰¾",
                    "ã€èªçŸ¥èªè¨€ã€‘å‡ºç¾ç‰™ç‰™å­¸èªçš„å¤šç¨®èªéŸ³çµ„åˆ",
                    "ã€ç¤¾æœƒã€‘æœƒèˆ‰é›™æ‰‹ç¤ºæ„è¦æŠ±æŠ±ï¼Œæˆ–æ®æ‰‹å†è¦‹",
                    "ã€ç¤¾æœƒã€‘æœƒæ¨¡ä»¿å¤§äººç°¡å–®å‹•ä½œï¼ˆå¦‚æ‹æ‰‹ã€å˜Ÿå˜´ï¼‰"
                ] 
            },
            { 
                minMo: 12, maxMo: 15, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘èƒ½è‡ªå·±æ‰¶è‘—å‚¢ä¿±èµ°æˆ–ç‰½æ‰‹èµ°",
                    "ã€ç²—å‹•ä½œã€‘æ‰¶è‘—å‚¢ä¿±å¯è¹²ä¸‹æ’¿ç‰©ä¸¦æ¢å¾©ç«™å§¿",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¯ç”¨æ‹‡æŒ‡åŠé£ŸæŒ‡å°æ¡æ‹¿å–è‘¡è„ä¹¾å¤§å°ç‰©å“",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¯ä»¥æŠŠç‰©å“æ”¾åœ¨å¤§äººæ‰‹ä¸­",
                    "ã€ç²¾ç´°å‹•ä½œã€‘èƒ½æŠŠç‰©å“æ”¾å…¥å¯¬å£å®¹å™¨ï¼ˆå¦‚ç©å…·ç¢—ï¼‰",
                    "ã€èªçŸ¥èªè¨€ã€‘æŒ‡è‘—ç†Ÿæ‚‰ç‰©å“å•ã€Œ...åœ¨å“ªè£¡?ã€ï¼Œæœƒç«‹åˆ»çœ‹å‘è©²ç‰©",
                    "ã€èªçŸ¥èªè¨€ã€‘è½æ‡‚ç°¡å–®æŒ‡ä»¤ï¼ˆæ‹æ‰‹ã€åä¸‹ã€éä¾†ï¼‰",
                    "ã€èªçŸ¥èªè¨€ã€‘æœƒèªª 1-2 å€‹æœ‰æ„ç¾©çš„è©å½™ï¼ˆå¦‚çˆ¸çˆ¸ã€åª½åª½ï¼‰",
                    "ã€ç¤¾æœƒã€‘å¯å’Œå¤§äººç©è‚¢é«”äº’å‹•éŠæˆ²ï¼ˆå¦‚æ“ŠæŒã€ç‚’è˜¿è””ï¼‰"
                ] 
            },
            { 
                minMo: 15, maxMo: 18, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘èƒ½æ”¾æ‰‹èµ°è‡³å°‘ 2-3 æ­¥ï¼Œç”šè‡³èµ°ç©©",
                    "ã€ç²—å‹•ä½œã€‘èƒ½æ”¾æ‰‹ç«™è‡³å°‘ 30 ç§’",
                    "ã€ç²¾ç´°å‹•ä½œã€‘èƒ½ä»¥æ‹‡æŒ‡é£ŸæŒ‡å°æ¡æŠ“ç©æœ¨",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¯æ‹¿ç­†åœ¨ç´™ä¸Šéš¨æ„å¡—é´‰",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å˜—è©¦ä½¿ç”¨æ¹¯åŒ™/å‰å­æˆ–æ‹¿æ¯å­",
                    "ã€èªçŸ¥èªè¨€ã€‘ç„¡æ‰‹å‹¢æç¤ºä¸‹è½æ‡‚æŒ‡ä»¤ï¼ˆæ‹¿OOã€é—œé–€ï¼‰",
                    "ã€èªçŸ¥èªè¨€ã€‘æœƒç”¨é£ŸæŒ‡æŒ‡å‘æƒ³è¦çš„ç‰©å“",
                    "ã€èªçŸ¥èªè¨€ã€‘æœƒèªª 5 å€‹ä»¥ä¸Šæœ‰æ„ç¾©çš„è©å½™",
                    "ã€ç¤¾æœƒã€‘æœƒæ¨¡ä»¿åˆ¥äººå‹•ä½œï¼ˆæ‹æ‰‹ã€æ‹œæ‹œï¼‰"
                ] 
            },
            { 
                minMo: 18, maxMo: 24, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥æ”¾æ‰‹èµ°å¾—å¾ˆç©©ï¼Œæ­¥æ…‹æ­£å¸¸",
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥è‡ªè¡Œå½è…°æˆ–è¹²ä¸‹ï¼Œç„¶å¾Œç«™èµ·ä¾†",
                    "ã€ç²¾ç´°å‹•ä½œã€‘èƒ½è‡ªå·±å˜—è©¦æ—‹é–‹ç“¶è“‹ï¼ˆå¤§äººæœªå¹«å¿™å›ºå®šï¼‰",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¯ä»¥ç–Šè‡³å°‘ 2 å¡Šç©æœ¨",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¯ä»¥æ‰“é–‹ç¹ªæœ¬ç¿»é ",
                    "ã€èªçŸ¥èªè¨€ã€‘æœƒæŒ‡å‡ºè‡³å°‘ä¸‰å€‹èº«é«”éƒ¨ä½ï¼ˆçœ¼ã€å£ã€æ‰‹ï¼‰",
                    "ã€èªçŸ¥èªè¨€ã€‘æŒ‡èªåœ–å¡ç‰©å“ï¼ˆå¦‚æ¹¯åŒ™ã€ç‹—ã€è»Šï¼‰è‡³å°‘å°3é¡Œ",
                    "ã€èªçŸ¥èªè¨€ã€‘æœƒèªª 10 å€‹ä»¥ä¸Šæœ‰æ„ç¾©è©å½™",
                    "ã€ç¤¾æœƒã€‘å•ã€ŒOOåœ¨å“ªè£¡?ã€æœƒè½‰é ­çœ‹æˆ–ç”¨æ‰‹æ¯”",
                    "ã€ç¤¾æœƒã€‘ç©éŠæˆ²æœ‰å‡æ‰®è¡Œç‚ºï¼ˆé¤µå¨ƒå¨ƒå–æ°´ï¼‰"
                ] 
            },
            { 
                minMo: 24, maxMo: 36, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥è‡ªå·±æ‰¶æ¬„æ†æˆ–æ”¾æ‰‹èµ°ä¸Šæ¨“æ¢¯",
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥å–®æ‰‹å‘å‰ä¸Ÿçƒ",
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥é›™è…³é›¢åœ°è·³",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¯ä»¥ç–Šé«˜è‡³å°‘ 4 å¡Šç©æœ¨",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¯ä»¥ç¨ç«‹æ—‹é–‹å°ç½å­ç“¶è“‹",
                    "ã€ç²¾ç´°å‹•ä½œã€‘æ‹¿ç­†ç•«å‡ºé€£çºŒåœ“åœˆã€ç›´ç·šæˆ–é‹¸é½’ç·š",
                    "ã€èªçŸ¥èªè¨€ã€‘æœƒæŠŠä¸åŒåŠŸèƒ½ç©å…·æ­é…ç©ï¼ˆè»Šè¼‰ç©æœ¨ã€å¨ƒå¨ƒç¡è¦ºï¼‰",
                    "ã€èªçŸ¥èªè¨€ã€‘çœ‹åœ–å¡å›ç­”èª°åœ¨æ´—æ‰‹/è¸¢çƒ/å–æ°´ï¼ˆå‹•ä½œæŒ‡èªï¼‰",
                    "ã€ç¤¾æœƒã€‘å°è‡ªå·±çš„åå­—æœ‰åæ‡‰ï¼ŒçŸ¥é“è‡ªå·±åå­—",
                    "ã€ç¤¾æœƒã€‘çœ‹åˆ°åˆ¥äººæœ‰æƒ…ç·’è®ŠåŒ–æœƒæœ‰åæ‡‰"
                ] 
            },
            { 
                minMo: 36, maxMo: 48, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥ç©©ç©©åœ°è·‘ 2 å…¬å°º",
                    "ã€ç²—å‹•ä½œã€‘å¯ç¨è‡ªä¸Šä¸‹æ¨“æ¢¯ï¼ˆä¸éœ€æ‰¶ï¼‰",
                    "ã€ç²—å‹•ä½œã€‘é›™è…³åŒæ™‚é›¢åœ°é€£çºŒè·³èºè‡³å°‘ 2 ä¸‹",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å¯ä»¥æ¨¡ä»¿ç•«å‡ºåœ“å½¢",
                    "ã€ç²¾ç´°å‹•ä½œã€‘ç”¨ 3-4 å¡Šç©æœ¨ä»¿ç–Šã€Œå“ã€æˆ–ã€Œç”°ã€å­—å½¢",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å–®æ‰‹å°‡å…©æšç¡¬å¹£ä¸€æ¬¡ä¸€å€‹æ”¶å…¥æ‰‹æŒå¿ƒ",
                    "ã€èªçŸ¥èªè¨€ã€‘å¯ä»¥ä¸€å•ä¸€ç­”æŒçºŒå°è©±ä¸”åˆ‡é¡Œ",
                    "ã€èªçŸ¥èªè¨€ã€‘çœ‹åœ–æè¿°å…§å®¹ï¼ˆä»–åœ¨åšä»€éº¼ï¼‰",
                    "ã€èªçŸ¥èªè¨€ã€‘èƒ½åˆ†è¾¨å¤§å°ï¼ˆå“ªä¸€å€‹çƒæ¯”è¼ƒå¤§ï¼‰",
                    "ã€ç¤¾æœƒã€‘å¯ä»¥å›ç­”è‡ªå·±çš„åå­—æˆ–å¹´é½¡"
                ] 
            },
            { 
                minMo: 48, maxMo: 60, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥è‡ªå·±æ”¾æ‰‹ä¸€è…³ä¸€éšä¸Šä¸‹æ¨“æ¢¯",
                    "ã€ç²—å‹•ä½œã€‘å¯ä»¥äº¤æ›¿è·¨æ­¥èµ°ç›´ç·š",
                    "ã€ç²—å‹•ä½œã€‘å–®è…³ç«™è‡³å°‘ 3 ç§’ï¼Œå–®è…³è·³è‡³å°‘ 2 ä¸‹",
                    "ã€ç²¾ç´°å‹•ä½œã€‘æ¨¡ä»¿å°‡ç´™å°æ‘ºä¸¦å£“å‡ºæ‘ºç—•",
                    "ã€ç²¾ç´°å‹•ä½œã€‘ä½¿ç”¨å‰ªåˆ€é€£çºŒå‘å‰å‰ªè‡³å°‘ 10 å…¬åˆ†",
                    "ã€ç²¾ç´°å‹•ä½œã€‘çœ‹åœ–ç•«å‡ºåå­—æˆ–æ–¹å½¢",
                    "ã€èªçŸ¥èªè¨€ã€‘çœ‹åœ–èªªæ•…äº‹ï¼ˆæ•˜è¿°æƒ…ç¯€ï¼‰",
                    "ã€èªçŸ¥èªè¨€ã€‘ç†è§£æ–¹ä½ï¼ˆä»€éº¼åœ¨æ¡Œå­ä¸‹é¢ï¼‰",
                    "ã€èªçŸ¥èªè¨€ã€‘æŒ‡èª 4 ç¨®é¡è‰²",
                    "ã€ç¤¾æœƒã€‘æœ‰è§’è‰²æ‰®æ¼”ç©æ³•ï¼ˆè€é—†ã€é†«ç”Ÿï¼‰",
                    "ã€ç¤¾æœƒã€‘èƒ½ç©©å®šåè‘—å›ç­”å•é¡Œ"
                ] 
            },
            { 
                minMo: 60, maxMo: 84, 
                items: [
                    "ã€ç²—å‹•ä½œã€‘ç©©å®šå–®è…³ç«™è‡³å°‘ 5 ç§’",
                    "ã€ç²—å‹•ä½œã€‘å–®è…³è·³ 5-10 ä¸‹",
                    "ã€ç²—å‹•ä½œã€‘è…³è·Ÿæ¥è…³å°–äº¤æ›¿å‘å‰èµ° 5 æ­¥ (Tandem gait)",
                    "ã€ç²¾ç´°å‹•ä½œã€‘çœ‹åœ–ç•«å‡ºä¸‰è§’å½¢ã€è±å½¢",
                    "ã€ç²¾ç´°å‹•ä½œã€‘ä½¿ç”¨å‰ä¸‰æŒ‡æ¡ç­†ç•«åœ–",
                    "ã€ç²¾ç´°å‹•ä½œã€‘å°‡å¤–å¥—æ‹‰éŠå…œå¥½ä¸¦æ‹‰èµ·",
                    "ã€èªçŸ¥èªè¨€ã€‘å®Œæ•´å¥å­æ•˜è¿°æ•…äº‹",
                    "ã€èªçŸ¥èªè¨€ã€‘ç†è§£å› æœé—œä¿‚ï¼ˆä»–ç‚ºä»€éº¼å“­ï¼Ÿï¼‰",
                    "ã€èªçŸ¥èªè¨€ã€‘æ­£ç¢ºæ•¸å‡ºç‰©å“æ•¸é‡ã€è¾¨èªæ•¸å­— 1-5",
                    "ã€èªçŸ¥èªè¨€ã€‘æ§‹éŸ³æ¸…æ™°",
                    "ã€ç¤¾æœƒã€‘éµå®ˆéŠæˆ²è¦å‰‡ï¼Œåƒèˆ‡åœ˜é«”æ´»å‹•",
                    "ã€ç¤¾æœƒã€‘å°ˆæ³¨åŠ›å¯æŒçºŒè¶…é 10 åˆ†é˜"
                ] 
            }
        ];

        // Teeth Data (Symmetric layout)
        const TEETH_LAYOUT = {
            primary: [ { type: 'incisor', angle: 10, erupt: [6,12], shed: [72,84] }, { type: 'incisor', angle: 25, erupt: [9,16], shed: [84,96] }, { type: 'canine', angle: 45, erupt: [16,23], shed: [108,144] }, { type: 'molar', angle: 65, erupt: [13,19], shed: [108,132] }, { type: 'molar', angle: 85, erupt: [23,33], shed: [120,144] } ],
            permanent: [ { type: 'incisor', angle: 8, erupt: [72,96] }, { type: 'incisor', angle: 20, erupt: [84,108] }, { type: 'canine', angle: 35, erupt: [108,144] }, { type: 'molar', angle: 50, erupt: [120,144] }, { type: 'molar', angle: 65, erupt: [120,144] }, { type: 'molar', angle: 80, erupt: [72,84] }, { type: 'molar', angle: 95, erupt: [132,156] }, { type: 'molar', angle: 110, erupt: [204,252] } ]
        };

        // --- CORE MATH ---
        function getLMS(gender, type, months) {
            const data = DATA_SOURCES[gender][type];
            if (!data) return null;
            if (months <= data[0][0]) return {L: data[0][1], M: data[0][2], S: data[0][3]};
            if (months >= data[data.length-1][0]) { const last = data[data.length-1]; return {L: last[1], M: last[2], S: last[3]}; }
            for (let i = 0; i < data.length - 1; i++) {
                if (months >= data[i][0] && months < data[i+1][0]) {
                    const t = (months - data[i][0]) / (data[i+1][0] - data[i][0]);
                    return { L: data[i][1] + t * (data[i+1][1] - data[i][1]), M: data[i][2] + t * (data[i+1][2] - data[i][2]), S: data[i][3] + t * (data[i+1][3] - data[i][3]) };
                }
            }
            return null;
        }
        function calculateZ(val, L, M, S) { return (L===0) ? Math.log(val/M)/S : (Math.pow(val/M, L)-1)/(L*S); }
        function erf(x) { var m=1.0,s=1.0,sum=x*1.0; for(var i=1;i<50;i++){ m*=i;s*=-1;sum+=(s*Math.pow(x,2.0*i+1.0))/(m*(2.0*i+1.0));} return 2*sum/Math.sqrt(Math.PI); }
        function zToPercentile(z) { if(isNaN(z))return'--'; if(z>5)return'>99.9'; if(z<-5)return'<0.1'; let p=(0.5*(1+erf(z/Math.sqrt(2))))*100; if(p<0.1)return'<0.1'; if(p>99.9)return'>99.9'; return p.toFixed(1); }
        function getValFromZ(z,L,M,S) { return (L===0) ? M*Math.exp(S*z) : M*Math.pow((1+L*S*z),1/L); }
        function calculateWater(weight) {
            if(!weight || weight<=0) return '--';
            let w = weight, water=0;
            if(w<=10) water=w*100; else if(w<=20) water=1000+(w-10)*50; else water=1500+(w-20)*20;
            return Math.round(water)+' ml';
        }

        // --- APP STATE ---
        let appData = { children: [] };
        let currentChildId = null;
        let chartInstance = null;
        let currentChartType = 'height';
        let confirmCallback = null;
        let currentView = 'listView';
        let currentTab = 'record';
        let dateModes = { rec: 'roc', newChild: 'roc' };

        function loadData() {
            const saved = localStorage.getItem('sheepGrowthApp');
            if (saved) { appData = JSON.parse(saved); appData.children.forEach(c => { if(!c.records) c.records=[]; }); }
            renderChildList();
            
            const savedState = localStorage.getItem('sheepAppState');
            if(savedState) {
                const state = JSON.parse(savedState);
                if(state.view === 'detailView' && state.childId) {
                     const child = appData.children.find(c => c.id === state.childId);
                     if(child) {
                         openChildDetail(state.childId);
                         if(state.tab) switchDetailTab(state.tab);
                     }
                }
            }
        }
        function saveData() { localStorage.setItem('sheepGrowthApp', JSON.stringify(appData)); }
        function saveAppState() { localStorage.setItem('sheepAppState', JSON.stringify({ view: currentView, childId: currentChildId, tab: currentTab })); }

        // --- HELPER: GET EVALUATED AGE (Corrected Age Logic) ---
        function getEvaluatedAge(child, targetDate) {
            const chronoMonths = moment(targetDate).diff(moment(child.dob), 'months', true);
            let evalMonths = chronoMonths;
            let isCorrected = false;
            let label = "";

            const weeks = child.weeks || 40;
            if (weeks < 37 && chronoMonths <= 36) { 
                const correctionMonths = (40 - weeks) * 7 / 30.4375; 
                const corrected = chronoMonths - correctionMonths;
                if (corrected > 0) {
                    evalMonths = corrected;
                    isCorrected = true;
                }
            }

            const y = Math.floor(evalMonths/12);
            const m = Math.floor(evalMonths%12);
            label = `${y}æ­²${m}å€‹æœˆ`;
            if (isCorrected) label += " (çŸ¯)";

            return { months: evalMonths, str: label, isCorrected };
        }

        // --- DATA BACKUP ---
        function exportData() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(appData));
            const dlAnchorElem = document.createElement('a');
            dlAnchorElem.setAttribute("href", dataStr);
            dlAnchorElem.setAttribute("download", "sheep_growth_backup_" + moment().format('YYYYMMDD') + ".json");
            dlAnchorElem.click();
        }

        function importData(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data && data.children && confirm('ç¢ºå®šè¦åŒ¯å…¥è³‡æ–™å—ï¼Ÿé€™å°‡æœƒè¦†è“‹ç¾æœ‰çš„ç´€éŒ„ã€‚')) {
                        appData = data; saveData(); loadData(); showAlert('æˆåŠŸ', 'è³‡æ–™å·²æˆåŠŸé‚„åŸï¼');
                    }
                } catch (err) { showAlert('éŒ¯èª¤', 'ç„¡æ³•è®€å–æª”æ¡ˆ'); }
            };
            reader.readAsText(file);
        }

        // --- DATE INPUT LOGIC ---
        function setDateInputs(prefix, dateStr) {
            const m = moment(dateStr); if (!m.isValid()) return;
            document.getElementById(prefix + 'Month').value = m.month() + 1;
            document.getElementById(prefix + 'Day').value = m.date();
            const y = m.year();
            // Default show ROC for display
            document.getElementById(prefix + 'Year').value = y - 1911;
        }
        function getDateStringFromInputs(prefix) {
            let y = parseInt(document.getElementById(prefix + 'Year').value);
            const m = parseInt(document.getElementById(prefix + 'Month').value);
            const d = parseInt(document.getElementById(prefix + 'Day').value);
            if (!y || !m || !d) return null;
            // Auto detect ROC (3 digits or less) vs AD (4 digits)
            if (y < 1911) y += 1911;
            const dateObj = moment(`${y}-${m}-${d}`, 'YYYY-M-D');
            return dateObj.isValid() ? dateObj.format('YYYY-MM-DD') : null;
        }

        // --- UI FUNCTIONS ---
        function applyTheme(gender) {
            document.body.classList.remove('theme-boy', 'theme-girl');
            if(gender==='boy') document.body.classList.add('theme-boy');
            else if(gender==='girl') document.body.classList.add('theme-girl');
        }
        function resetTheme() { document.body.classList.remove('theme-boy', 'theme-girl'); }

        function showView(viewName) {
            document.getElementById('listView').classList.add('hidden');
            document.getElementById('detailView').classList.add('hidden');
            document.getElementById(viewName).classList.remove('hidden');
            currentView = viewName;
            if(viewName === 'listView') { 
                renderChildList(); 
                currentChildId = null; 
                resetTheme(); 
            }
            saveAppState();
        }

        function renderChildList() {
            const container = document.getElementById('childrenContainer');
            const emptyState = document.getElementById('emptyState');
            container.innerHTML = '';
            if (appData.children.length === 0) { emptyState.classList.remove('hidden'); return; }
            emptyState.classList.add('hidden');
            appData.children.forEach(child => {
                const ageInfo = getEvaluatedAge(child, moment());
                const genderIcon = child.gender === 'boy' ? 'ğŸ‘¦' : 'ğŸ‘§';
                const borderColor = child.gender === 'boy' ? 'border-blue-100 hover:border-blue-300' : 'border-pink-100 hover:border-pink-300';
                const card = document.createElement('div');
                card.className = `bg-white p-5 rounded-xl border ${borderColor} shadow-sm hover:shadow-md transition cursor-pointer flex justify-between items-center`;
                card.onclick = () => openChildDetail(child.id);
                card.innerHTML = `<div class="flex items-center gap-4"><div class="w-12 h-12 rounded-full flex items-center justify-center text-2xl border bg-gray-50 border-gray-100">${genderIcon}</div><div><h3 class="font-bold text-lg text-gray-800">${child.name}</h3><p class="text-xs text-gray-500">${child.dob} (${ageInfo.str})</p><span class="text-xs mt-1 inline-block bg-gray-50 px-2 py-0.5 rounded text-gray-600">ç´€éŒ„: ${child.records.length} ç­†</span></div></div><div class="text-gray-400"><i class="fas fa-chevron-right"></i></div>`;
                container.appendChild(card);
            });
        }

        function saveNewChild() {
            const name = document.getElementById('newChildName').value.trim();
            const gender = document.querySelector('input[name="newChildGender"]:checked').value;
            const dob = getDateStringFromInputs('newChild');
            const weeks = parseInt(document.getElementById('newChildWeeks').value) || 40;

            if (!name || !dob) { showAlert('è³‡æ–™ä¸å®Œæ•´', 'è«‹å¡«å¯«å®Œæ•´æ—¥æœŸèˆ‡æš±ç¨±ï¼'); return; }
            const age = moment().diff(moment(dob), 'years', true);
            if (age < 0) { showAlert('æ—¥æœŸéŒ¯èª¤', 'å‡ºç”Ÿæ—¥æœŸä¸èƒ½æ™šæ–¼ä»Šå¤©ã€‚'); return; }
            if (age > 99) { showAlert('å¹´é½¡é™åˆ¶', 'åƒ…æ”¯æ´ 0-99 æ­²çš„ç”Ÿé•·ç´€éŒ„ã€‚'); return; }
            
            // Migration: Add weeks to data structure
            appData.children.push({ id: Date.now().toString(), name, gender, dob, weeks: weeks, records: [] });
            saveData(); closeModal('addChildModal'); document.getElementById('addChildForm').reset(); renderChildList();
        }

        function openChildDetail(id) {
            currentChildId = id;
            const child = appData.children.find(c => c.id === id);
            if(!child) return;
            
            showView('detailView'); // Update state inside
            applyTheme(child.gender);
            document.getElementById('detailName').innerText = child.name;
            document.getElementById('detailDob').innerText = child.dob;
            document.getElementById('detailGender').innerText = child.gender === 'boy' ? 'ç”·å¯¶' : 'å¥³å¯¶';
            document.getElementById('detailGender').className = `px-2 py-1 rounded text-xs font-bold ${child.gender === 'boy' ? 'bg-blue-100 text-blue-600' : 'bg-pink-100 text-pink-500'}`;
            
            // Age Display using Corrected Logic
            const ageInfo = getEvaluatedAge(child, moment());
            document.getElementById('detailAge').innerText = ageInfo.str;
            
            // Show Premature tag ONLY if < 37 weeks AND age < 3 years
            const chronoAgeYears = moment().diff(moment(child.dob), 'years', true);
            const premTag = document.getElementById('detailPremature');
            if (child.weeks < 37 && chronoAgeYears < 3) {
                premTag.innerText = `(æ—©ç”¢ ${child.weeks}é€±)`;
                premTag.classList.remove('hidden');
            } else {
                premTag.classList.add('hidden');
            }

            // Update Advice uses Corrected Age
            const currentAgeYears = ageInfo.months / 12;
            updateDoctorAdvice(currentAgeYears, child.gender);
            
            // Set Default Record Date (ROC)
            setDateInputs('rec', moment().format('YYYY-MM-DD'));
            
            document.getElementById('recHeight').value = ''; document.getElementById('recWeight').value = ''; document.getElementById('recHead').value = '';
            document.getElementById('instantResult').classList.add('hidden');
            renderHistoryTable(child);
            renderTeeth(ageInfo.months);
            switchDetailTab(currentTab || 'record');
        }
        
        function updateDoctorAdvice(ageYears, gender) {
            const adviceData = ADVICE_DATA.find(d => {
                const ageMatch = ageYears >= d.min && ageYears < d.max;
                const genderMatch = !d.gender || d.gender === gender;
                return ageMatch && genderMatch;
            });
            const defaultAdvice = { title: "å¥åº·æˆé•·", list: ["æ¯å€‹å­©å­éƒ½æœ‰è‡ªå·±çš„ç”Ÿé•·è»Œè·¡ï¼Œå¥åº·å¿«æ¨‚æœ€é‡è¦ï¼", "å‡è¡¡é£²é£Ÿã€å……è¶³ç¡çœ ã€é©åº¦é‹å‹•æ˜¯é•·é«˜çš„ä¸‰å¤§æ³•å¯¶ã€‚"] };
            const finalAdvice = adviceData || defaultAdvice;
            const randomText = finalAdvice.list[Math.floor(Math.random() * finalAdvice.list.length)];
            document.getElementById('adviceTitle').innerText = finalAdvice.title;
            document.getElementById('adviceText').innerText = randomText;
        }

        function deleteCurrentChild() {
            showConfirm('åˆªé™¤ç¢ºèª', 'ç¢ºå®šè¦åˆªé™¤é€™ä½å°æœ‹å‹çš„æ‰€æœ‰è³‡æ–™å—ï¼Ÿåˆªé™¤å¾Œç„¡æ³•å¾©åŸå–”ï¼', () => {
                appData.children = appData.children.filter(c => c.id !== currentChildId);
                saveData(); showView('listView');
            });
        }

        function calculatePrediction() {
            const dad = parseFloat(document.getElementById('predDad').value);
            const mom = parseFloat(document.getElementById('predMom').value);
            const child = appData.children.find(c => c.id === currentChildId);
            
            if (!dad || !mom || !child) { showAlert('è³‡æ–™ä¸è¶³', 'è«‹è¼¸å…¥çˆ¸çˆ¸èˆ‡åª½åª½çš„èº«é«˜ã€‚'); return; }

            let base = 0;
            if (child.gender === 'boy') base = (dad + mom + 12) / 2;
            else base = (dad + mom - 12) / 2;

            const rangeMin = (base - 7.5).toFixed(1);
            const rangeMax = (base + 7.5).toFixed(1);
            
            document.getElementById('predValue').innerText = base.toFixed(1);
            document.getElementById('predRange').innerText = `${rangeMin} ~ ${rangeMax} cm`;
            document.getElementById('predResult').classList.remove('hidden');
        }

        function renderDevelopment(ageMonths) { // Input: Corrected Age
            const container = document.getElementById('devListContainer');
            container.innerHTML = '';
            const stage = DATA_DEVELOPMENT.find(s => ageMonths >= s.minMo && ageMonths < s.maxMo);
            
            if (!stage) {
                const msg = ageMonths > 84 ? "å­¸é½¡å¾Œï¼šæ³¨é‡å­¸æ ¡é©æ‡‰èˆ‡å¸¸è¦å»ºç«‹ã€‚" : "æ–°ç”Ÿå…’ï¼šè«‹å¤šè§€å¯Ÿåƒç¡ç‹€æ³ã€‚";
                document.getElementById('devAgeStage').innerText = ageMonths > 84 ? "å­¸é½¡å¾Œ" : "æ–°ç”Ÿå…’";
                container.innerHTML = `<div class="p-4 text-center text-gray-500">${msg}</div>`;
                return;
            }

            document.getElementById('devAgeStage').innerText = `${stage.minMo}~${stage.maxMo} å€‹æœˆ`;
            stage.items.forEach(item => {
                container.innerHTML += `<div class="flex items-start gap-3 bg-white p-3 rounded-lg border border-gray-100 shadow-sm"><div class="mt-1 w-5 h-5 rounded-full border-2 border-theme text-theme-primary flex items-center justify-center text-xs flex-shrink-0"><i class="fas fa-check"></i></div><span class="text-gray-700 font-medium">${item}</span></div>`;
            });
        }

        function renderVaccines(ageMonths, dob) { // Input: Chronological Age, DOB
            const container = document.getElementById('vaccineListContainer');
            container.innerHTML = '';
            const dobDate = moment(dob);
            
            const grouped = {};
            DATA_VACCINES.forEach(v => { if(!grouped[v.ageMo]) grouped[v.ageMo]=[]; grouped[v.ageMo].push(v.name); });
            const ages = Object.keys(grouped).map(Number).sort((a,b)=>a-b);

            ages.forEach(ageMo => {
                const names = grouped[ageMo];
                const dueDate = dobDate.clone().add(ageMo, 'months');
                const diffMonths = ageMonths - ageMo;
                
                let sClass="border-gray-200 bg-gray-50", sIcon="circle", sColor="text-gray-300", sText="";

                if (diffMonths >= 1) { 
                    sClass="border-green-100 bg-green-50"; sIcon="check-circle"; sColor="text-green-600"; sText="æ‡‰å·²æ–½æ‰“";
                } else if (diffMonths >= -1 && diffMonths < 1) { 
                    sClass="border-yellow-100 bg-yellow-50"; sIcon="clock"; sColor="text-yellow-500"; sText="è¿‘æœŸç•™æ„";
                } else { 
                    sClass="border-blue-100 bg-blue-50"; sIcon="calendar-alt"; sColor="text-blue-500"; sText="é è¨ˆ "+dueDate.format('YYYY/MM');
                }

                const ageLabel = ageMo === 0 ? 'å‡ºç”Ÿ24hå…§' : (ageMo >= 12 ? `${Math.floor(ageMo/12)}æ­²${ageMo%12?ageMo%12+'å€‹æœˆ':''}` : `${ageMo}å€‹æœˆ`);
                const namesHtml = names.map(n => `<div class="mb-1 text-sm font-bold text-gray-700 flex items-start gap-2"><span class="text-gray-400 mt-1 text-[10px]">â—</span><span>${n}</span></div>`).join('');

                container.innerHTML += `<div class="flex justify-between items-center p-4 rounded-xl border ${sClass} shadow-sm"><div class="flex-1"><div class="text-xs text-gray-500 mb-2 font-mono bg-white inline-block px-2 py-0.5 rounded border border-gray-200">${ageLabel}</div><div class="pl-1">${namesHtml}</div></div><div class="flex flex-col items-end ml-3 min-w-[80px]"><i class="fas fa-${sIcon} ${sColor} text-2xl mb-1"></i><span class="text-xs font-bold ${sColor} text-right">${sText}</span></div></div>`;
            });
        }

        function renderTeeth(ageMonths) { // Input: Corrected Age
            document.getElementById('teethAgeDisplay').innerText = (ageMonths/12).toFixed(1) + " æ­²";
            
            ['upper', 'lower'].forEach(pos => {
                const container = document.getElementById('jaw' + (pos === 'upper' ? 'Upper' : 'Lower'));
                const label = container.querySelector('.arch-label');
                container.innerHTML = ''; 
                container.appendChild(label);
                
                const centerX = 150; 
                // Identical Anchor and Radii for Symmetry
                const anchorY = pos === 'upper' ? 140 : 20; 
                const rPermX = 100; const rPermY = 90;
                const rPrimaryX = 70; const rPrimaryY = 60;
                const anchorY_actual = pos === 'upper' ? 130 : 30;

                TEETH_LAYOUT.permanent.forEach(t => renderToothPair(container, t, ageMonths, centerX, anchorY_actual, pos, rPermX, rPermY, 'permanent'));
                TEETH_LAYOUT.primary.forEach(t => renderToothPair(container, t, ageMonths, centerX, anchorY_actual, pos, rPrimaryX, rPrimaryY, 'primary'));
            });

            let text = "æ†ç‰™åˆ—æœŸï¼Œ28-32é¡†ç‰™é½’é€æ¼¸é•·é½Šã€‚";
            if (ageMonths < 6) text = "å°æœ‹å‹é‚„åœ¨é•·ç‰™æº–å‚™æœŸï¼Œå¯ä»¥ç”¨ç´—å¸ƒå·¾æ¸…æ½”ç‰™é½¦å–”ï¼";
            else if (ageMonths < 30) text = "ä¹³ç‰™èŒç™¼æœŸï¼Œå¤§ç´„ 6-10 å€‹æœˆé•·ç¬¬ä¸€é¡†ç‰™ã€‚";
            else if (ageMonths < 72) text = "ä¹³ç‰™åˆ—å®ŒæˆæœŸï¼Œå…±æœ‰20é¡†ä¹³ç‰™ã€‚è«‹å”åŠ©å­©å­ä½¿ç”¨ç‰™ç·šã€‚";
            else if (ageMonths < 144) text = "æ›ç‰™æœŸï¼Œä¹³ç‰™é–‹å§‹è„«è½ï¼Œæ†ç‰™èŒç™¼ã€‚æ³¨æ„å…­æ­²å¤§è‡¼é½’æ¸…æ½”ã€‚";
            document.getElementById('teethStageText').innerText = text;
        }

        function renderToothPair(container, data, age, cx, anchorY, jawPos, rx, ry, type) {
            const rad = data.angle * (Math.PI / 180);
            const dx = Math.sin(rad) * rx;
            const dy = Math.cos(rad) * ry;
            
            let y, rotL, rotR;
            if (jawPos === 'upper') {
                y = anchorY - dy;
                rotL = -data.angle;
                rotR = data.angle;
            } else {
                y = anchorY + dy;
                rotL = 180 + data.angle;
                rotR = 180 - data.angle;
            }

            let status = 'shed';
            let isErupted = age >= data.erupt[0];
            let isShed = false;
            if (data.shed) isShed = age >= data.shed[0];

            if (type === 'primary') {
                if (isShed) status = 'shed';
                else if (isErupted) status = 'erupted';
                else status = 'shed'; 
            } else {
                if (isErupted) status = 'erupted';
                else status = 'shed'; 
            }

            [-1, 1].forEach(side => {
                const el = document.createElement('div');
                el.className = `tooth-container`;
                el.style.left = `${(cx + (side * dx)) - 12}px`; 
                el.style.top = `${y - 20}px`; 
                
                const rotation = side === -1 ? rotL : rotR;
                el.style.transform = `rotate(${rotation}deg)`;

                const mark = document.createElement('div');
                mark.className = `tooth-mark ${type} ${status} ${data.type}`;
                
                el.appendChild(mark);
                container.appendChild(el);
            });
        }

        function renderRecommendations(ageYears) { // Input: Corrected Age
            const bookContainer = document.getElementById('bookList');
            const gameContainer = document.getElementById('gameList');
            bookContainer.innerHTML = ''; gameContainer.innerHTML = '';

            const bookCat = BOOKS_LIBRARY.find(b => ageYears >= b.ageMin && ageYears < b.ageMax) || BOOKS_LIBRARY[BOOKS_LIBRARY.length-1];
            const gameCat = GAMES_LIBRARY.find(g => ageYears >= g.ageMin && ageYears < g.ageMax) || GAMES_LIBRARY[GAMES_LIBRARY.length-1];

            const shuffledBooks = [...bookCat.list].sort(() => 0.5 - Math.random()).slice(0, 5);
            const randomGame = gameCat.list[Math.floor(Math.random() * gameCat.list.length)];

            shuffledBooks.forEach(book => {
                const tagsHtml = book.tags.map(t => `<span class="item-tag book">${t}</span>`).join('');
                bookContainer.innerHTML += `<div class="flex items-center gap-3 bg-gray-50 p-3 rounded-lg border border-gray-100 hover:bg-white hover:shadow-sm transition"><div class="w-8 h-8 flex-shrink-0 bg-theme-accent text-theme-primary rounded flex items-center justify-center font-bold text-lg"><i class="fas fa-book"></i></div><div><div class="text-sm font-medium text-gray-700">${book.title}</div><div class="mt-1">${tagsHtml}</div></div></div>`;
            });
            
            const gameTagsHtml = randomGame.tags.map(t => `<span class="item-tag game">${t}</span>`).join('');
            gameContainer.innerHTML = `<div class="flex items-center gap-3 bg-yellow-50 p-3 rounded-lg border border-yellow-100 hover:bg-white hover:shadow-sm transition"><div class="w-8 h-8 flex-shrink-0 bg-yellow-200 text-yellow-700 rounded flex items-center justify-center font-bold text-lg"><i class="fas fa-dice"></i></div><div><div class="text-sm font-medium text-gray-700">${randomGame.title}</div><div class="mt-1">${gameTagsHtml}</div></div></div>`;
        }

        function refreshRecommendations() {
             const child = appData.children.find(c => c.id === currentChildId);
             if(!child) return;
             renderRecommendations(moment().diff(moment(child.dob), 'years', true));
        }

        function switchDetailTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById('content-' + tabName).classList.remove('hidden');
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById('tab-' + tabName).classList.add('active');
            
            const child = appData.children.find(c => c.id === currentChildId); if(!child) return;
            const chronoMonths = moment().diff(moment(child.dob), 'months', true);
            const ageInfo = getEvaluatedAge(child, moment()); // Corrected Age

            currentTab = tabName;
            saveAppState();

            if(tabName === 'chart') updateChart();
            if(tabName === 'teeth') renderTeeth(ageInfo.months); // Use Corrected
            if(tabName === 'recommend') renderRecommendations(ageInfo.months / 12); // Use Corrected
            if(tabName === 'development') renderDevelopment(ageInfo.months); // Use Corrected
            if(tabName === 'vaccine') renderVaccines(chronoMonths, child.dob); // Use Chronological
        }

        function addRecord() {
            const child = appData.children.find(c => c.id === currentChildId);
            const date = getDateStringFromInputs('rec');
            const h = parseFloat(document.getElementById('recHeight').value);
            const w = parseFloat(document.getElementById('recWeight').value);
            const hd = parseFloat(document.getElementById('recHead').value);

            if (!date || (!h && !w && !hd)) { showAlert('è³‡æ–™ä¸è¶³', 'è«‹è‡³å°‘è¼¸å…¥æ—¥æœŸå’Œä¸€é …æ¸¬é‡æ•¸æ“šã€‚'); return; }
            const recAge = moment(date).diff(moment(child.dob), 'years', true);
            if (recAge < 0) { showAlert('æ—¥æœŸéŒ¯èª¤', 'æ¸¬é‡æ—¥æœŸä¸èƒ½æ—©æ–¼å‡ºç”Ÿæ—¥æœŸã€‚'); return; }
            if (recAge > 99) { showAlert('å¹´é½¡é™åˆ¶', 'åƒ…æ”¯æ´ 99 æ­²ä»¥ä¸‹çš„æ¸¬é‡ç´€éŒ„ã€‚'); return; }

            child.records.push({ id: Date.now().toString(), date, height: h||null, weight: w||null, head: hd||null });
            child.records.sort((a,b) => new Date(a.date) - new Date(b.date));
            saveData();
            
            // Calculate using Corrected Age for Evaluation
            const ageInfo = getEvaluatedAge(child, date);
            const resH = h ? calculatePercentile(child.gender, 'height', ageInfo.months, h) : '--';
            const resW = w ? calculatePercentile(child.gender, 'weight', ageInfo.months, w) : '--';
            const resHd = hd ? calculatePercentile(child.gender, 'head', ageInfo.months, hd) : '--';
            const resWater = w ? calculateWater(w) : '--';
            
            document.getElementById('resHeight').innerText = resH + (resH !== '--' ? '%' : '');
            document.getElementById('resWeight').innerText = resW + (resW !== '--' ? '%' : '');
            document.getElementById('resHead').innerText = resHd + (resHd !== '--' ? '%' : '');
            document.getElementById('resWater').innerText = resWater;
            document.getElementById('instantResult').classList.remove('hidden');
            renderHistoryTable(child);
        }

        function renderHistoryTable(child) {
            const tbody = document.getElementById('historyTableBody'); tbody.innerHTML = '';
            
            // Sort by Date Ascending
            const sortedRecords = [...child.records].sort((a,b) => new Date(a.date) - new Date(b.date));

            sortedRecords.forEach(rec => {
                const ageInfo = getEvaluatedAge(child, rec.date);
                
                const pH = rec.height ? calculatePercentile(child.gender, 'height', ageInfo.months, rec.height)+'%' : '-';
                const pW = rec.weight ? calculatePercentile(child.gender, 'weight', ageInfo.months, rec.weight)+'%' : '-';
                const pHd = rec.head ? calculatePercentile(child.gender, 'head', ageInfo.months, rec.head)+'%' : '-';
                const water = rec.weight ? calculateWater(rec.weight) : '-';

                const tr = document.createElement('tr'); tr.className = "hover:bg-gray-50";
                tr.innerHTML = `<td class="p-4 whitespace-nowrap text-sm">${rec.date}</td><td class="p-4 whitespace-nowrap text-gray-500 text-xs">${ageInfo.str}</td><td class="p-4"><div class="font-bold">${rec.height||'-'}</div><div class="text-xs text-blue-500">${pH}</div></td><td class="p-4"><div class="font-bold">${rec.weight||'-'}</div><div class="text-xs text-green-500">${pW}</div></td><td class="p-4"><div class="font-bold">${rec.head||'-'}</div><div class="text-xs text-purple-500">${pHd}</div></td><td class="p-4 text-blue-400 font-bold">${water}</td><td class="p-4 text-right"><button onclick="deleteRecord('${rec.id}')" class="text-red-300 hover:text-red-500 p-2"><i class="fas fa-trash"></i></button></td>`;
                tbody.appendChild(tr);
            });
        }
        function deleteRecord(recId) { showConfirm('åˆªé™¤ç´€éŒ„', 'ç¢ºå®šè¦åˆªé™¤é€™ç­†ç´€éŒ„å—ï¼Ÿ', () => { const c = appData.children.find(x => x.id === currentChildId); c.records = c.records.filter(r => r.id !== recId); saveData(); renderHistoryTable(c); updateChart(); }); }
        
        function calculatePercentile(gender, type, months, val) { if(val===null || (type==='head'&&months>60)) return '--'; const lms = getLMS(gender, type, months); if(!lms) return '--'; const z = calculateZ(val, lms.L, lms.M, lms.S); return zToPercentile(z); }
        function getAgeString(dob, target) { const d = moment.duration(moment(target).diff(moment(dob))); return `${d.years()}y ${d.months()}m`; }
        
        function switchChartType(type, btn) { currentChartType = type; document.querySelectorAll('.chart-tab-btn').forEach(b => { b.classList.remove('active', 'font-bold', 'text-theme-primary', 'border-b-2', 'border-theme'); b.classList.add('text-gray-500'); }); btn.classList.add('active', 'font-bold', 'text-theme-primary', 'border-b-2', 'border-theme'); btn.classList.remove('text-gray-500'); updateChart(); }
        
        function updateChart() {
            const ctx = document.getElementById('growthChart').getContext('2d');
            if (chartInstance) chartInstance.destroy();
            const child = appData.children.find(c => c.id === currentChildId); if(!child) return;
            const type = currentChartType; const maxMonths = type === 'head' ? 60 : 216; let chartColor = child.gender==='boy'?'#42A5F5':'#EC407A';
            const d3=[], d15=[], d50=[], d85=[], d97=[]; const steps = 36;
            for (let i = 0; i <= maxMonths; i += (maxMonths/steps)) {
                const lms = getLMS(child.gender, type, i);
                if (lms) { d3.push({x:i,y:getValFromZ(-1.88,lms.L,lms.M,lms.S)}); d50.push({x:i,y:getValFromZ(0,lms.L,lms.M,lms.S)}); d97.push({x:i,y:getValFromZ(1.88,lms.L,lms.M,lms.S)}); }
            }
            
            // User Data Points: Use CORRECTED AGE
            const userData = child.records
                .filter(r => r[type] !== null && r[type] !== undefined)
                .map(r => {
                    const ageInfo = getEvaluatedAge(child, r.date); // Get corrected months
                    if (ageInfo.months < 0 || ageInfo.months > maxMonths) return null;
                    return { x: ageInfo.months, y: parseFloat(r[type]), date: r.date };
                })
                .filter(d => d !== null);

            chartInstance = new Chart(ctx, { type: 'line', data: { datasets: [{ label: 'å°æœ‹å‹ç´€éŒ„', data: userData, backgroundColor: chartColor, borderColor: chartColor, pointRadius: 6, showLine: false, type: 'scatter' }, { label: '97%', data: d97, borderColor: '#ef9a9a', borderWidth: 1, pointRadius: 0, fill: false, tension: 0.4 }, { label: '50%', data: d50, borderColor: '#81c784', borderWidth: 2, pointRadius: 0, fill: false, tension: 0.4 }, { label: '3%', data: d3, borderColor: '#ef9a9a', borderWidth: 1, pointRadius: 0, fill: false, tension: 0.4 }] }, options: { responsive: true, maintainAspectRatio: false, scales: { x: { type: 'linear', max: maxMonths } } } });
        }

        // Modals
        function openModal(id) { 
            const m=document.getElementById(id); m.classList.remove('opacity-0','pointer-events-none'); document.body.classList.add('modal-active'); m.querySelector('.modal-container').classList.remove('scale-95','opacity-0'); 
            if(id==='addChildModal') {
                setDateInputs('newChild', moment().format('YYYY-MM-DD'));
            }
        }
        function closeModal(id) { const m=document.getElementById(id); m.classList.add('opacity-0','pointer-events-none'); document.body.classList.remove('modal-active'); m.querySelector('.modal-container').classList.add('scale-95','opacity-0'); }
        function showConfirm(t,m,cb) { document.getElementById('confirmTitle').innerText=t; document.getElementById('confirmMessage').innerText=m; confirmCallback=cb; openModal('confirmModal'); }
        document.getElementById('confirmYesBtn').onclick = function() { if(confirmCallback) confirmCallback(); closeModal('confirmModal'); confirmCallback=null; };
        function showAlert(t,m) { document.getElementById('alertTitle').innerText=t; document.getElementById('alertMessage').innerText=m; openModal('alertModal'); }

        window.onload = loadData;
    </script>
</body>
</html>
